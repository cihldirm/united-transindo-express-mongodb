<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <meta http-equiv="X-UA-Compatible" content="ie=edge" /> -->
    <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="initial-scale=1.0, target-densitydpi=device-dpi" /><!-- this is for mobile (Android) Chrome -->
    <meta name="viewport" content="initial-scale=1.0, width=device-height"><!--  mobile Safari, FireFox, Opera Mobile  -->
    <script type="text/javascript" src="/vendors/jSignature/libs/modernizr.js"></script>
    <title>United Transindo Admin Dashboard</title>
    <link rel="icon" type="image/x-icon" href="/images/icons/Logo United Transindo.ico">
    <!-- core:css -->
    <link rel="stylesheet" href="/vendors/core/core.css" />
    <!-- endinject -->
    <!-- plugin css for this page -->
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- Bootstrap Msg CSS -->
    <!-- <link rel="stylesheet" href="/css/bootstrap-msg.css"> -->
    <!-- Font Awesome 4 -->
    <link rel="stylesheet" href="/vendors/font-awesome/css/font-awesome.min.css">
    <!-- <link rel="stylesheet" href="https://select2.github.io/select2/select2-3.5.2/select2.css"> -->
    <link rel="stylesheet" href="/vendors/select2/select2.min.css">
    <link rel="stylesheet" href="/vendors/bootstrap-datepicker/bootstrap-datepicker.min.css">
    <link rel="stylesheet" href="/vendors/mdi/css/materialdesignicons.min.css">
    <link
      rel="stylesheet"
      href="/vendors/sweetalert2/sweetalert2.min.css"
    />
    <!-- end plugin css for this page -->
    <!-- inject:css -->
    <link
      rel="stylesheet"
      href="/fonts/feather-font/css/iconfont.css"
    />
    <link
      rel="stylesheet"
      href="/vendors/flag-icon-css/css/flag-icon.min.css"
    />
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="/css/demo_1/style.css" />
    
    <!--[if lt IE 9]>
    <script type="text/javascript" src="/vendors/jSignature/libs/flashcanvas.js"></script>
    <![endif]-->
    <style>
      /* #choose-jo-city {
        background-color: #fff;
        height: 450px;
        border: 1px solid;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        gap: 2rem;

        & #container {
          display: grid;
          gap: 0.75rem;

          & .city {
            background-color: #fff;
            width: 100px;
            height: 50px;
          }
        }
      } */
      .page-content {
        padding-bottom: 0 !important;
        display: grid;
      }
      .datepicker.datepicker-dropdown.dropdown-menu {
        z-index: 1000 !important;
      }
      .datepicker table tr td.disabled, .datepicker table tr td.disabled:hover {
        color: #999 !important;
      }
      .select2-container--default .select2-selection--single .select2-selection__clear {
        margin-left: 30px;
      }
      .select2-selection.select2-selection--single {
        display: inline-grid;
        padding-right: 40px !important;
      }
      .spinner-border {
        position: absolute;
        top: calc(50% + 30px);
        left: calc(50% + 120px);
      }
      #jo-template {
        background-color: #fff;
        margin: auto;
        width: 770px;
      }
      
      #jo-template > #header {
        display: flex;
        justify-content: center;
        align-items: center;
        /* font-size: 0.75rem; */
        font-size: 0.625rem;
        gap: 2rem;
        margin-bottom: 0.5rem;

        -webkit-touch-callout: none; /* iOS Safari */
        -webkit-user-select: none; /* Safari */        
        -khtml-user-select: none; /* Konqueror HTML */
        -moz-user-select: none; /* Old versions of Firefox */
        -ms-user-select: none; /* IE10+/Edge */
        user-select: none; /* Standard & Non-prefixed version, currently
        supported by Chrome, Edge, Opera and Firefox */

        & div:nth-child(1) {
          white-space: nowrap;
        }
        & div:nth-child(3) {
          text-align: right;
          white-space: nowrap;
        }
      }
      #jo-template #content {

      }
      #jo-template #content > #header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border: 1px solid;
        border-bottom: unset;
        /* padding: 0.75rem 2rem; */
        padding: 1rem 2rem;
        /* & h5 {
            font-weight: bold;
            line-height: 0;
        } */
        & div:nth-child(1) > h6 {
          font-weight: 800;
        }
        & div:nth-child(2) > span {
          & #no_joj {
            &:empty:before {
              content: "\feff"; /* ZERO WIDTH NO-BREAK SPACE */
            }
          }
        }
      }
      #jo-template #content > #container {
        border: 1px solid;
        padding-left: 2rem;
        padding-right: 2rem;
        & h3 {
            padding: 2rem;
            text-decoration: underline;
            text-align: center;
            font-size: 26px;
            font-weight: 800;
        }
        /* & label {
          height: 2rem;
        } */
        /* & select:enabled + span.select2.select2-container span.select2-selection.select2-selection--single {
          border: 1px solid;
        } */
        & input[type="radio"]:disabled {
          cursor: unset;
        }
        & select:disabled + span.select2.select2-container span.select2-selection.select2-selection--single,
          input[type="text"]:disabled, input[type="radio"]:disabled + i.input-frame::before {
            border: 1px solid darkgrey !important;
            background-color: lightgrey !important;

          /* &:focus {
            background-color: lightgrey;
          } */
        }
        /* & .form-group.has-danger .select2-container .select2-selection--single { */
        & .form-group {
          & span.select2.select2-container {
            /* margin-left: 0.75rem; */

            & span.select2-selection.select2-selection--single {
              /* display: inline-grid;
              padding-right: 40px !important;
              border: 1px solid;
              border-radius: 4px; */

              & span.select2-selection__arrow {
                width: 100%;
                height: 100%;
                z-index: auto;

                & b {
                  left: unset;
                  right: 14px;
                  margin-top: -6px;
                }
              }

              & .select2-selection__clear {
                margin-left: 30px;
                z-index: 100;
              }
            }
          }

          &.has-danger .select2-container .select2-selection--single {
            border-color: #ff3366 !important;
          }
        }
        & span.select2.select2-container span.select2-selection.select2-selection--single {
          display: inline-grid;
          padding-right: 40px !important;
          border: 1px solid;
          border-radius: 4px;
        }
        & #data-customer {
          display: grid;

          & .form-group.form-row {
            height: 2.1875rem;
            margin: 0;
            margin-bottom: 0.25rem;
            display: inline-table;
            /* display: flex;
            align-items: center;
            flex-wrap: nowrap; */
          }
          & label {
            margin: 0;
            width: 120px;
            line-height: 1;
            vertical-align: unset;

            &.error {
              width: unset;
              margin-left: 0.75rem;
            }
          }
          .my_select2_optgroup_selected {
              background-color: #ddd;
          }
          .my_select2_optgroup_hovered {
              color: #FFF;
              background-color: #5897fb !important;
              cursor: pointer;
          }
          strong.select2-results__group {
              padding: 0 !important;
          }
          .my_select2_optgroup {
              display: block;
              padding: 6px;
          }
          .select2-dropdown, . {
            width: 600px !important;
            max-width: 600px !important;
          }
          /* & span.select2.select2-container {
            margin-left: 0.75rem;

            & span.select2-selection.select2-selection--single {
              display: inline-grid;
              padding-right: 40px !important;
              border: 1px solid;

              & span.select2-container--default .select2-selection--single .select2-selection__clear {
                margin-left: 30px;
              }
            }
          } */
        }
        & #data-kendaraan {
          & .form-group.form-row {
            height: 2.1875rem;
            margin: 0;
            margin-bottom: 0.25rem;
            /* display: inline-table; */
            display: flex;
            align-items: center;
            flex-wrap: nowrap;
          }
          & .quantity {
            margin-left: 0.75rem;
            display: flex;
            /* border: 2px solid #3498db; */
            border: 1px solid darkgrey;
            border-radius: 4px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);

            & button {
              /* background-color: #3498db; */
              color: #fff;
              border: none;
              cursor: pointer;
              /* font-size: 20px;
              width: 30px; */
              height: auto;
              text-align: center;
              transition: background-color 0.2s;
            }
            & .btn-danger:disabled {
              background-color: darkgrey;
              cursor: unset;
            }
          }

          & .input-box {
            /* width: 40px; */
            text-align: center;
            border: none;
            /* padding: 8px 10px;
            font-size: 16px; */
            outline: none;
          }

          /* Hide the number input spin buttons */
          & .input-box::-webkit-inner-spin-button,
            .input-box::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
          }

          & .input-box[type="number"] {
            -moz-appearance: textfield;
          }
          & .table th, .table td {
            border: 1px solid darkslategrey !important;
          }
          & .table tbody th {
            text-align: center;
          }
          & .table tbody td.has-danger .select2-container .select2-selection--single {
            border-color: #ff3366 !important;
          }
          & .table tbody :nth-child(6) {
            & .text-danger {
              .error {
                margin: 0;
                margin-top: 0.5rem;
                display: flex;
                justify-content: center;
              }
            }

            & .form-group:has(+ .text-danger .error:not([style*="display: none"])) .form-check .input-frame::before {
              border: solid #ff3366;
            }
          }
          & label.form-label {
            margin: 0;
            width: 60px;
            line-height: 1;
          }
          & label.form-check-label {
            display: flex;
            margin: 0;
            gap: 0.5rem;
          }
          & label.error {
            margin: 0;
            margin-left: 0.75rem;
          }
          & .form-check-input {
            position: relative;
          }
          & i.input-frame {
            position: absolute;
          }
          & .table input.form-control[type="text"] {
            width: max-content;
            margin: 0;
            border-color: rgb(118, 118, 118);
          }
          & span.select2.select2-container {
            /* margin-left: 0.75rem; */
            width: max-content;
          }
        }
        & #pembayaran {
          & .form-group.form-row {
            height: 2.1875rem;
            margin: 0;
            margin-bottom: 0.25rem;
            /* display: inline-table; */
            display: flex;
            align-items: center;
            flex-wrap: nowrap;
          }
          & label {
            margin: 0;
            width: 85px;
            line-height: 1;
            /* vertical-align: unset; */
          }
          & .form-check.form-check-inline {
            margin: 0;
            display: flex;
            align-items: center;
          }
          & input.form-control {
            width: 192px;
            min-width: 192px;
            /* margin: 0 0.625rem; */
            margin-left: 0.75rem;
            border-color: rgb(118,118,118);
          }
        }
        & #detail-pembayaran-1 {
          & .form-group.form-row {
            height: 2.1875rem;
            margin: 0;
            margin-bottom: 0.25rem;
            /* display: inline-table; */
            display: flex;
            align-items: center;
            flex-wrap: nowrap;
          }
          & span.form-label {
            margin: 0;
            /* min-width: 80px;
            width: 80px; */
            min-width: 90px;
            width: 90px;
            line-height: 1;
            /* vertical-align: unset; */
            /* min-width: 120px;
            width: 120px; */
            /* min-width: 150px;
            width: 150px; */
          }
          & input.form-control {
            /* margin: 0 0.625rem; */
            /* margin-left: 0.75rem; */
            margin-left: 0.625rem;
            border-color: rgb(118,118,118);
          }
          & label.form-check-label {
            display: flex;
            margin: 0;
            gap: 0.5rem;
          }
          & input[name="tagihan"], input[name="opsi_tagihan_top"] {
            position: relative;
          }
          & i.input-frame {
            position: absolute;
          }
        }
        & #detail-pembayaran-2 {
          & .form-group.form-row {
            height: 2.1875rem;
            margin: 0;
            margin-bottom: 0.25rem;
            /* display: inline-table; */
            display: flex;
            align-items: center;
            flex-wrap: nowrap;
          }
          & span.form-label {
            margin: 0;
            min-width: 150px;
            width: 150px;
            line-height: 1;
            /* vertical-align: unset; */
          }
          & input.form-control {
            /* margin: 0 0.625rem; */
            /* margin-left: 0.75rem; */
            margin-left: 0.625rem;
            border-color: rgb(118,118,118);
          }
          & label.form-check-label {
            display: flex;
            margin: 0;
            gap: 0.5rem;
          }
          & i.input-frame {
            position: absolute;
          }
          & input[name="asuransi"], input[name="biaya_koord"] {
            position: relative;
          }
          #note {
            color: black;
            border-color: rgb(118, 118, 118);
            min-width: 192px;
            line-height: normal;
            height: auto;
            min-height: 2.1875rem;

            &[placeholder]:empty:before {
              cursor: text;
              content: attr(placeholder);
              color: #555; 
            }

            &[placeholder]:empty:focus:before {
              content: "";
            }
          }
        }
        & .form-check .form-check-label {
          display: inline;
        }
        & .hr_tgl_ambil.input-group.date.datepicker {
          width: 250px;
          margin-left: 0.75rem;
          /* width: fit-content; */
          display: inline-flex;
          border: 1px solid;
          border-radius: 4px;

          & span.input-group-addon {
            border-left: 1px solid;
          }
        }
        .datepicker.datepicker-dropdown.dropdown-menu {
          z-index: 1000;
        }
        & #qty {
          padding: 0;
          width: 1.2ch;
          margin: 0 0.5rem;
        }
        /* & #lainnya {
            position: relative;
            margin: 0 0.5rem;
        } */
        & #nominal {
          border-color: rgb(118,118,118);
        }
        input::placeholder {
          color: #999;
          opacity: 1; /* Firefox */
        }
        input::-ms-input-placeholder { /* Edge 12 -18 */
          color: #999;
        }
        /* & .form-control-danger {
          border-color: #ff3366 !important;
        } */
      }
      #jo-template #content > #footer {
        border: 1px solid;
        border-top: unset;
        display: flex;
        text-align: center;

        /* & div.col-3 {
          height: 100px;
        } */

        /*This is the div within which the signature canvas is fitted*/
        & #signature-made-by,
          #signature-approved-by,
          #signature-received-by-1,
          #signature-received-by-2 {
            height: 100px;
            position: relative;
            /* border: 1px solid; */


            & div img {
              display: none !important;
            }
            
            & canvas.jSignature {
            }

            & span {
              position: absolute;
              /* bottom: 2px; */
              top: 2px;
              right: 2px;
              font-size: 11px;
              line-height: 1;
              text-align: right;
            }
        }
      }
      /* .alert-div > div.alert.alert-danger{
        font-weight: bold;
        text-align: center;
        width: fit-content;
        margin: auto;
        transition: 1s;
      }
      div.alert{
        display: flex;
        font-weight: bold;
        width: fit-content;
        margin: auto;
        transition: 1s;
        label{
          margin: 0;
        }
        button.close{
          padding: 0;
          top: unset;
          right: 1.25rem;
        }
      }
      .alert.show{
        animation: show_slide 1.2s ease forwards;
      }

      .alert.hide{
        animation: hide_slide 1.2s ease forwards;
      }

      @keyframes show_slide{
        0%{
          transform: translateX(100%);
        }
        45%{
          transform: translateX(-5%);
          opacity: 0.4;
        }
        75%{
          transform: translateX(2%);
          opacity: 0.8;
        }
        100%{
          transform: translateX(-2%);
          opacity: 1;
        }
      }

      @keyframes hide_slide{
        0%{
          opacity: 1;
          transform: translateX(0%);
        }
        100%{
          opacity: 0;
          transform: translateX(100%);
        }
      } */
    </style>
    <!-- End layout styles -->
    <link
      rel="shortcut icon"
      href="/images/icons/Logo United Transindo.png"
    />
  </head>
  <body>
    <div class="main-wrapper">
      <!-- partial:partials/_sidebar.html -->
      <%- include('./sidebar.ejs') %>
      <!-- partial -->

      <div class="page-wrapper">
        <!-- partial:partials/_navbar.html -->
        <%- include('./navbar.ejs') %>
        <!-- partial -->

        <div class="page-content">
          <div class="alert-div" style="display: none;">
            <!-- <div class="alert alert-icon-danger" role="alert">
              <i data-feather="alert-triangle"></i>
              A simple danger alert—check it out!
            </div> -->
          </div>
          <!-- <div class="alert alert-icon-danger" role="alert">
            <i data-feather="alert-circle"></i>
            A simple danger alert—check it out!
          </div> -->

          <!-- <div class="alert alert-icon-danger alert-danger alert-dismissible fade show" role="alert" style="display: none;">
            <i data-feather="alert-circle"></i>
            <label></label>
            <button type="button" class="close" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div> -->
        
          <nav class="page-breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="#">Marketing</a></li>
              <li class="breadcrumb-item active" aria-current="page">
                Input Job Order
              </li>
            </ol>
          </nav>

          <!-- <div id="choose-jo-city">
            <h4>Pilih Kota :</h4>
            <div id="container">
              <button class="city" id="Sidoarjo">Sidoarjo</button>
              <button class="city" id="Jakarta">Jakarta</button>
              <button class="city" id="Makassar">Makassar</button>
            </div>
          </div> -->
          <div class="spinner-border" role="status">
            <span class="sr-only">Loading...</span>
          </div>
          <div id="jo-template" style="display: none;">
            <div id="header">
              <div class="">
                Jl. Raya Bulevar Barat Komp. Ruko Plaza </br>
                Pasifik Blok A 3 No. 58 Jakarta </br>
                Telp. (021) 4535007-8, Fax. (021) 45865813
              </div>
              <div class="">
                <img width="270" height="50" src="/images/Logo Header PT UT.jpeg" alt="logo-header-job-order" draggable="false" />
              </div>
              <div class="">
                Komplek Pergudangan Sinar Buduran II Blok A No. 09 </br>
                Jl. Lingkar Timur Prasung, Buduran - Sidoarjo </br>
                Telp. (031) 99708669, Fax. (031) 9970879
              </div>
            </div>
            <form method="post" action="/input-job-order" id="jo-form" name="jo-form">
                <div id="content">
                    <div id="header">
                        <div class="">
                            <h6></h6>
                        </div>
                        <div class="">
                            <span>No. JO :</span>
                        </div>
                    </div>
                    <div id="container">
                        <h3>JOB ORDER</h3>
                        <span style="font-weight: bold;"> <span>1.</span> &emsp; &emsp; <span style="text-decoration: underline;">Data Customer</span> </span>
                        <br/>
                        <br/>
                        <fieldset>
                        <div id="data-customer">
                          <div class="form-group form-row">
                            <label for="nama_pengirim">Nama Pengirim</label> <span style="margin-right: .75rem;">:</span>
                            <select name="nama_pengirim" id="nama_pengirim" class="nama_pengirim form-control"></select>
                            <!-- <label for="nama_pengirim" id="nama_pengirim-error" class="error text-danger"></label> -->
                          </div>
                          <div class="form-group form-row">
                            <label for="alamat_pengirim">Alamat Pengirim</label> <span style="margin-right: .75rem;">:</span>
                            <select name="alamat_pengirim" id="alamat_pengirim" class="alamat_pengirim form-control" disabled></select>
                          </div>
                          <div class="form-group form-row">
                            <label for="kontak_pengirim">Telp.</label> <span style="margin-right: .75rem;">:</span>
                            <select name="kontak_pengirim" id="kontak_pengirim" class="kontak_pengirim form-control" disabled></select>
                          </div>
                          <!-- <br/> -->
                          <br/>
                          <!-- <div class="form-group form-row">
                            <select id="e1" style="width:300px;">
                              <optgroup label="A1 comps">
                                  <option value="A1">AAA 1</option>
                                  <option value="A2">AAA 2</option>
                                  <option value="A#">AAA 3</option>
                                  <option value="A4">AAA 4</option>
                              </optgroup>
                              <optgroup label="B1 comps">
                                  <option value="B1">BBB 1</option>
                                  <option value="B2">BBB 2</option>
                                  <option value="B3">BBB 3</option>
                                  <option value="B4">BBB 4</option>
                              </optgroup>
                            </select>
                          </div> -->
                          <div class="form-group form-row">
                            <label for="nama_penerima">Nama Penerima</label> <span style="margin-right: .75rem;">:</span>
                            <select name="nama_penerima" id="nama_penerima" class="form-control"></select>
                          </div>
                          <div class="form-group form-row">
                            <label for="alamat_penerima">Alamat Penerima</label> <span style="margin-right: .75rem;">:</span>
                            <select name="alamat_penerima" id="alamat_penerima" class="alamat_penerima form-control" disabled></select>
                          </div>
                          <div class="form-group form-row">
                            <label for="kontak_penerima">Telp.</label> <span style="margin-right: .75rem;">:</span>
                            <select name="kontak_penerima" id="kontak_penerima" class="kontak_penerima form-control" disabled></select>
                          </div>
                          <!-- <select id="my-select" name="my-select" class="my-select form-control"></select> -->
                          <!-- <select id="my-select" class="example"  style="width: 300px">
                            <option value="JAN">January</option>
                            <option value="FEB">February</option>
                            <option value="MAR">March</option>
                            <option value="APR">April</option>
                            <option value="MAY">May</option>
                            <option value="JUN">June</option>
                            <option value="JUL">July</option>
                            <option value="AUG">August</option>
                            <option value="SEP">September</option>
                            <option value="OCT">October</option>
                            <option value="NOV">November</option>
                            <option value="DEC">December</option>
                          </select> -->
                        </div>
                        <!-- <br/> -->
                        <br/>
                        <span style="font-weight: bold;"> <span>2.</span> &emsp; &emsp; <span style="text-decoration: underline;">Hari / Tanggal Pengambilan</span> : <div class="hr_tgl_ambil input-group date datepicker">
                          <input type="text" id="hr_tgl_ambil" name="hr_tgl_ambil" class="form-control"><span class="input-group-addon"><i data-feather="calendar"></i></span>
                        </div> </span>
                        <br/>
                        <br/>
                        <span style="font-weight: bold;"> <span>3.</span> &emsp; &emsp; <span style="text-decoration: underline;">Data Kendaraan</span> </span>
                        <br/>
                        <br/>
                        <div id="data-kendaraan">
                          <div class="form-group form-row">
                            <label for="qty" class="form-label">Jumlah</label> :
                            <div class="quantity">
                              <button type="button" class="btn-danger minus" aria-label="Decrease" disabled>&minus;</button>
                              <input type="number" id="qty" name="qty" class="input-box" value="1" min="1">
                              <button type="button" class="btn-success plus" aria-label="Increase">&plus;</button>
                            </div>
                            <span style="margin-left: 0.75rem;">Unit</span>
                          </div>
                          <br/>
                          <div class="table-responsive">
                            <table class="table table-bordered">
                              <thead>
                                <tr>
                                  <th>No</th>
                                  <th>Merk</th>
                                  <th>Type</th>
                                  <th>Nopol / Noka</th>
                                  <th>Warna</th>
                                  <th>Status</th>
                                  <th>Kondisi Surat</th>
                                </tr>
                              </thead>
                              <tbody>
                                <!-- <tr>
                                  <th>1</th>
                                  <td><select name="merk[0]" id="merk-1" class="merk form-control form-group"></select></td>
                                  <td><select name="tipe[0]" id="tipe-1" class="tipe form-control form-group" disabled></select></td>
                                  <td><input type="text" name="nopol_noka[0]" id="nopol_noka-1" class="form-control form-group" style="min-width: max-content;" placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ." disabled /></td>
                                  <td><select name="warna[0]" id="warna-1" class="warna form-control form-group" disabled></select></td>
                                  <td>
                                    <fieldset>
                                    <div class="form-group" id="status-1" style="display: flex; margin: 0;">
                                      <div class="form-check form-check-inline" 
                                        style="
                                          margin: 0;
                                          margin-right: 0.75rem;
                                        ">
                                        <label class="form-check-label">
                                          <input
                                            type="radio"
                                            class="form-check-input"
                                            name="status[0]"
                                            id="status-profit-1"
                                            value="profit"
                                            disabled
                                            required
                                          />
                                          Profit
                                        </label>
                                      </div>
                                      <div class="form-check form-check-inline" 
                                        style="
                                          margin: 0;
                                          margin-left: 0.75rem;
                                        ">
                                        <label class="form-check-label">
                                          <input
                                            type="radio"
                                            class="form-check-input"
                                            name="status[0]"
                                            id="status-second-1"
                                            value="second"
                                            disabled
                                          />
                                          Second
                                        </label>
                                      </div>
                                    </div>
                                    <span class="text-danger" style="display: none;">
                                      <label for="status[0]" class="error" style="display: none;">Mohon Pilih Status Unit</label>
                                    </span>
                                  </fieldset>
                                  </td>
                                  <td>
                                    <div class="form-group" style="display: flex; margin: 0;">
                                      <div class="form-check form-check-inline" style="margin: 0; margin-right: 0.75rem;">
                                        <label class="form-check-label">
                                          <input
                                            type="radio"
                                            class="form-check-input"
                                            name="kondisi[0]"
                                            id="kondisi-ada-1"
                                            value="ada"
                                            disabled
                                          />
                                          Ada
                                        </label>
                                      </div>
                                      <div class="form-check form-check-inline" style="margin: 0; margin-left: 0.75rem; display: flex; align-items: center; min-width: max-content;">
                                        <label class="form-check-label">
                                          <input
                                            type="radio"
                                            class="form-check-input"
                                            name="kondisi[0]"
                                            id="kondisi-lainnya-1"
                                            value="lainnya"
                                            disabled
                                          />
                                          Lainnya
                                        </label>
                                        <input
                                          type="text"
                                          class="form-control"
                                          name="lainnya[0]"
                                          id="lainnya-1"
                                          placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                          style="margin-left: 0.625rem;"
                                          disabled
                                          />
                                      </div>
                                    </div>
                                  </td>
                                </tr> -->
                              </tbody>
                            </table>
                          </div>
                        </div>
                          
                        <!-- <br/> -->
                        <br/>
                        <span style="font-weight: bold;"> <span>4.</span> &emsp; &emsp; <span style="text-decoration: underline;">Pembayaran</span> </span>
                        <br/>
                        <br/>
                        <div id="pembayaran">
                          <div id="nominal-row" class="form-group form-row">
                            <label for="nominal">Nominal</label> :
                            <div class="form-check form-check-inline">
                              <input
                                id="nominal"
                                class="form-control"
                                name="nominal"
                                placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                data-autosize-input='{ "space": 0 }'
                              />
                            </div>
                          </div>
                          <div class="form-group form-row">
                            <label for="moda">Moda</label> :
                            <div class="form-check form-check-inline">
                              <input
                                type="text"
                                class="form-control"
                                name="moda"
                                id="moda"
                                placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                data-autosize-input='{ "space": 0 }'
                              />
                            </div>
                          </div>
                          <div id="invoice-row" class="form-group form-row">
                            <label for="invoice">Invoice a.n.</label> :
                            <div class="form-check form-check-inline">
                              <input
                                type="text"
                                class="form-control"
                                name="invoice"
                                id="invoice"
                                placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                data-autosize-input='{ "space": 0 }'
                              />
                            </div>
                            <br/>
                          </div>
                        </div>
                        <!-- <br/> -->
                        <!-- <span style="font-weight: bold;"> <span>4.</span> &emsp; &emsp; <span style="text-decoration: underline;">Pembayaran</span> </span> -->
                        <div id="detail-pembayaran-1">
                          <hr />
                          <div class="form-group form-row">
                            <span style="min-width: 50px; width: 50px;">1.</span>
                            <span class="form-label">Transfer By</span> :
                            <!-- 1.<label for="form-label">&emsp; &emsp;Transfer By</label> : -->
                            <div class="form-check form-check-inline" style="margin: 0; display: flex; align-items: center;">
                              <input
                                type="text"
                                class="form-control"
                                name="transfer_by"
                                id="transfer_by"
                                placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                              />
                            </div>
                          </div>
                          <hr />
                          <div class="form-group form-row">
                            <span style="min-width: 50px; width: 50px;">2.</span>
                            <span class="form-label">Tagihan</span> : 
                            <div class="space" style="margin-right: 10px;"></div>
                            <div class="form-group" style="display: flex; margin: 0; white-space: nowrap; width: 100%; justify-content: space-evenly;">
                              <!-- <div class="form-check form-check-inline" style="margin: 0 0.75rem 0 1.5rem; align-self: center;"> -->
                              <div class="col-3 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <!-- <label class="form-check-label" style="margin-bottom: 0; display: flex;"> -->
                                <label for="tagihan-jakarta" class="form-check-label" style="width: 5.5rem;">
                                  <input
                                    type="radio"
                                    class="form-check-input"
                                    name="tagihan"
                                    id="tagihan-jakarta"
                                    value="jakarta"
                                  />
                                  Jakarta
                                </label>
                              </div>
                              <!-- <div class="col-4 form-check form-check-inline" style="margin: 0 0.75rem; align-self: center;"> -->
                              <div class="col-3 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label for="tagihan-sidoarjo" class="form-check-label" style="width: 5.5rem;">
                                  <input
                                    type="radio"
                                    class="form-check-input"
                                    name="tagihan"
                                    id="tagihan-sidoarjo"
                                    value="sidoarjo"
                                  />
                                  Sidoarjo
                                </label>
                              </div>
                              <!-- <div class="col-4 form-check form-check-inline" style="margin: 0 0.75rem; display: flex; align-items: center;"> -->
                              <div class="col-6 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  padding-left: 1rem;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label for="tagihan_top" class="form-check-label" style="margin: 0; position: relative; display: flex; align-items: center;">
                                  TOP :
                                </label>
                                <input
                                  type="text"
                                  class="form-control"
                                  name="tagihan_top"
                                  id="tagihan_top"
                                  placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                  disabled
                                />
                                <div id="opsi_tagihan_top" style="display: none; margin-left: 1rem;">
                                  <div class="form-group" style="display: grid; margin: 0; white-space: nowrap; gap: 0.5rem;">
                                    <!-- <div class="form-check form-check-inline" style="margin: 0 0.75rem 0 1.5rem; align-self: center;"> -->
                                    <div class="form-check form-check-inline" 
                                      style="
                                        margin: 0;
                                        padding: 0;
                                    ">
                                      <label for="tagihan_top-hari_kerja" class="form-check-label" style="margin-bottom: 0;">
                                        <input
                                          type="radio"
                                          class="form-check-input"
                                          name="opsi_tagihan_top"
                                          id="tagihan_top-hari_kerja"
                                          value="hari_kerja"
                                          checked
                                        />
                                        Hari Kerja
                                      </label>
                                    </div>
                                    <!-- <div class="form-check form-check-inline" style="margin: 0 0.75rem 0 1.5rem; align-self: center;"> -->
                                    <div class="form-check form-check-inline" 
                                      style="
                                        margin: 0;
                                        padding: 0;
                                    ">
                                      <label for="tagihan_top-kalender" class="form-check-label" style="margin-bottom: 0;">
                                        <input
                                          type="radio"
                                          class="form-check-input"
                                          name="opsi_tagihan_top"
                                          id="tagihan_top-kalender"
                                          value="kalender"
                                        />
                                        Kalender
                                      </label>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <hr />
                          <div class="form-group form-row">
                            <span style="min-width: 50px; width: 50px;">3.</span>
                            <span class="form-label">Penawaran / Kontrak</span> : 
                            <div class="space" style="margin-right: 10px;"></div>
                            <div class="form-group" style="display: flex; margin: 0; white-space: nowrap; width: 100%; justify-content: space-evenly;">
                              <div class="col-3 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label class="form-check-label" style="width: 5.5rem;">
                                  <input
                                    type="radio"
                                    class="form-check-input"
                                    name="penawaran_kontrak"
                                    id=""
                                    value="tidak_ada"
                                    style="position: relative;"
                                  />
                                  Tidak Ada
                                </label>
                              </div>
                              <div class="col-3 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label class="form-check-label" style="width: 5.5rem;">
                                  <input
                                    type="radio"
                                    class="form-check-input"
                                    name="penawaran_kontrak"
                                    id=""
                                    value="ada"
                                    style="position: relative;"
                                  />
                                  Ada
                                </label>
                                <!-- <div id="opsi_penawaran_kontrak" style="display: none; margin-left: 1rem;">
                                  <div class="form-group" style="display: grid; margin: 0; white-space: nowrap; gap: 0.5rem;">
                                    <div class="form-check form-check-inline" 
                                      style="
                                        margin: 0;
                                        padding: 0;
                                    ">
                                      <label class="form-check-label" style="margin-bottom: 0;">
                                        <input
                                          type="radio"
                                          class="form-check-input"
                                          name="opsi_penawaran_kontrak"
                                          id="penawaran"
                                          value="hari_kerja"
                                          checked
                                        />
                                        Surat Penawaran
                                      </label>
                                    </div>
                                    <div class="form-check form-check-inline" 
                                      style="
                                        margin: 0;
                                        padding: 0;
                                    ">
                                      <label class="form-check-label" style="margin-bottom: 0;">
                                        <input
                                          type="radio"
                                          class="form-check-input"
                                          name="opsi_penawaran_kontrak"
                                          id="kontrak"
                                          value="kontrak"
                                        />
                                        Kontrak
                                      </label>
                                    </div>
                                    <div class="form-check form-check-inline" 
                                      style="
                                        margin: 0;
                                        padding: 0;
                                    ">
                                      <label class="form-check-label" style="margin-bottom: 0;">
                                        <input
                                          type="radio"
                                          class="form-check-input"
                                          name="opsi_penawaran_kontrak"
                                          id="ban"
                                          value="ban"
                                        />
                                        BAN (Berita Acara Negosiasi)
                                      </label>
                                    </div>
                                  </div>
                                </div>
                                <div id="field_opsi_penawaran_kontrak" style="display: none; margin-left: 1rem;">
                                  <div class="form-check form-check-inline" 
                                    style="
                                      margin: 0;
                                      padding: 0;
                                      padding-left: 1rem;
                                      align-self: center;
                                      justify-content: center;
                                      display: flex;
                                    ">
                                    <label for="no_opsi_penawaran_kontrak" class="form-check-label" style="margin: 0; position: relative; display: flex; align-items: center;">
                                      No.
                                    </label>
                                    <input
                                      type="text"
                                      class="form-control"
                                      name="no_opsi_penawaran_kontrak"
                                      id="no_opsi_penawaran_kontrak"
                                      placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                      disabled
                                    />
                                  </div>
                                </div> -->
                              </div>
                              <!-- <div class="col-6 form-check form-check-inline"></div> -->
                              <div class="col-6 form-group" 
                                style="
                                  /* display: grid;  */
                                  margin: 0; 
                                  padding: 0;
                                  /* margin-left: 1rem; 
                                  white-space: nowrap; 
                                  gap: 0.5rem; */
                                ">
                                <div id="opsi_penawaran_kontrak" 
                                  style="
                                    display: none;
                                    /* display: grid;
                                    gap: 0.5rem;
                                    margin: 0;
                                    margin-left: 1rem;
                                    margin-top: 0.5rem; */
                                    /* display: none; 
                                    height: unset; */
                                  ">
                                  <div class="form-check form-check-inline" 
                                    style="
                                      margin: 0;
                                      padding: 0;
                                    ">
                                    <label class="form-check-label" style="width: 5.5rem;">
                                      <input
                                        type="radio"
                                        class="form-check-input"
                                        name="opsi_penawaran_kontrak"
                                        id="surat_penawaran"
                                        value="surat_penawaran"
                                        checked
                                        style="position: relative;"
                                      />
                                      Surat Penawaran
                                    </label>
                                  </div>
                                  <div class="form-check form-check-inline" 
                                    style="
                                      margin: 0;
                                      padding: 0;
                                    ">
                                    <label class="form-check-label" style="width: 5.5rem;">
                                      <input
                                        type="radio"
                                        class="form-check-input"
                                        name="opsi_penawaran_kontrak"
                                        id="kontrak"
                                        value="kontrak"
                                        style="position: relative;"
                                      />
                                      Kontrak
                                    </label>
                                  </div>
                                  <div class="form-check form-check-inline" 
                                    style="
                                      margin: 0;
                                      padding: 0;
                                  ">
                                    <label class="form-check-label" style="width: 5.5rem;">
                                      <input
                                        type="radio"
                                        class="form-check-input"
                                        name="opsi_penawaran_kontrak"
                                        id="ban"
                                        value="ban"
                                        style="position: relative;"
                                      />
                                      BAN (Berita Acara Negosiasi)
                                    </label>
                                  </div>
                                  <div class="form-check form-check-inline" 
                                    style="
                                      margin: 0;
                                      padding: 0;
                                      /* margin-left: 1rem;
                                      padding-left: 1rem;
                                      align-self: center;
                                      justify-content: center;
                                      display: flex; */
                                    ">
                                    <label for="no_opsi_penawaran_kontrak" class="form-check-label" style="margin: 0; position: relative; display: flex; align-items: center;">
                                      No.
                                    </label>
                                    <input
                                      type="text"
                                      class="form-control"
                                      name="no_opsi_penawaran_kontrak"
                                      id="no_opsi_penawaran_kontrak"
                                      placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                    />
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <hr />
                          <div class="form-group form-row">
                            <span style="min-width: 50px; width: 50px;">4.</span>
                            <span class="form-label">Handling</span> :
                            <div class="space" style="margin-right: 10px;"></div>
                            <div class="form-group" style="display: flex; margin: 0; white-space: nowrap; width: 100%; justify-content: space-evenly;">
                              <div class="col-3 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label class="form-check-label" style="width: 5.5rem;">
                                  <input
                                    type="radio"
                                    class="form-check-input"
                                    name="handling"
                                    id=""
                                    value="tidak_ada"
                                    style="position: relative;"
                                  />
                                  Tidak Ada
                                </label>
                              </div>
                              <div class="col-3 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label class="form-check-label" style="width: 5.5rem;">
                                  <input
                                    type="radio"
                                    class="form-check-input"
                                    name="handling"
                                    id=""
                                    value="ada"
                                    style="position: relative;"
                                  />
                                  Ada
                                </label>
                              </div>
                              <div class="col-6 form-check form-check-inline" 
                                style="
                                  /* display: grid;  */
                                  margin: 0; 
                                  padding: 0;
                                  /* margin-left: 1rem; 
                                  white-space: nowrap; 
                                  gap: 0.5rem; */
                                ">
                                <div id="form_handling" 
                                  style="
                                    display: none;
                                    /* display: grid;
                                    gap: 0.5rem;
                                    margin: 0;
                                    margin-left: 1rem;
                                    margin-top: 0.5rem; */
                                    /* display: none; 
                                    height: unset; */
                                  ">
                                  <div class="form-check form-check-inline" 
                                    style="
                                      margin: 0;
                                      padding: 0;
                                    ">
                                    <label for="nominal_handling" class="form-check-label" style="margin: 0; position: relative; display: flex; align-items: center;">
                                      Nominal :
                                    </label>
                                    <input
                                      type="text"
                                      class="form-control"
                                      name="nominal_handling"
                                      id="nominal_handling"
                                      placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                    />
                                  </div>
                                  <div class="form-check form-check-inline" 
                                    style="
                                      margin: 0;
                                      padding: 0;
                                    ">
                                    <label for="nama_penerima_handling" class="form-check-label" style="margin: 0; position: relative; display: flex; align-items: center;">
                                      Nama Penerima :
                                    </label>
                                    <input
                                      type="text"
                                      class="form-control"
                                      name="nama_penerima_handling"
                                      id="nama_penerima_handling"
                                      placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                    />
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <hr />
                          <br/>
                          <br/>
                        </div>
                        <div id="detail-pembayaran-2">
                          <div class="form-group form-row">
                            <span class="form-label">Asuransi</span> :
                            <div class="form-group" style="display: flex; margin: 0; white-space: nowrap; width: 100%; justify-content: space-evenly;">
                              <div class="col-3 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label class="form-check-label" style="margin-bottom: 0; display: flex; width: 5.5rem;">
                                  <input
                                    type="radio"
                                    class="form-check-input"
                                    name="asuransi"
                                    id="asuransi-tidak_ada"
                                    value="tidak_ada"
                                  />
                                  Tidak Ada
                                </label>
                              </div>
                              <div class="col-3 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label class="form-check-label" style="width: 5.5rem;">
                                  <input
                                    type="radio"
                                    class="form-check-input"
                                    name="asuransi"
                                    id="asuransi-ada"
                                    value="ada"
                                  />
                                  Ada
                                </label>
                              </div>
                              <div class="col-6 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  padding-left: 1rem;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label for="perincian_asuransi" class="form-check-label" style="margin: 0; position: relative; display: flex; align-items: center;">
                                  Perincian
                                </label>
                                <input
                                  type="text"
                                  class="form-control"
                                  name="perincian_asuransi"
                                  id="perincian_asuransi"
                                  placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                  disabled
                                />
                              </div>
                            </div>
                          </div>
                          <div class="form-group form-row">
                            <span class="form-label">Biaya Koord / Kawal</span> :
                            <div class="form-group" style="display: flex; margin: 0; white-space: nowrap; width: 100%; justify-content: space-evenly;">
                              <div class="col-3 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label class="biaya_koord form-check-label" style="width: 5.5rem;">
                                  <input
                                    type="radio"
                                    class="form-check-input"
                                    name="biaya_koord"
                                    id="biaya_koord-tidak_ada"
                                    value="tidak_ada"
                                  />
                                  Tidak Ada
                                </label>
                              </div>
                              <div class="col-3 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label class="biaya_koord form-check-label" style="width: 5.5rem;">
                                  <input
                                    type="radio"
                                    class="form-check-input"
                                    name="biaya_koord"
                                    id="biaya_koord-ada"
                                    value="ada"
                                  />
                                  Ada
                                </label>
                              </div>
                              <div class="col-6 form-check form-check-inline" 
                                style="
                                  margin: 0;
                                  padding: 0;
                                  padding-left: 1rem;
                                  align-self: center;
                                  justify-content: center;
                                  display: flex;
                                ">
                                <label for="keterangan_biaya_koord" class="form-check-label" style="margin: 0; position: relative; display: flex; align-items: center;">
                                  Ket.
                                </label>
                                <input
                                  type="text"
                                  class="form-control"
                                  name="keterangan_biaya_koord"
                                  id="keterangan_biaya_koord"
                                  placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                                  disabled
                                />
                              </div>
                            </div>
                          </div>
                          <div class="form-group form-row" style="height: auto;">
                            <label for="note" style="margin: 0; width: 110px; min-width: 110px;"><b>Note</b></label><b style="font-weight: 400;">:</b>
                            <div class="form-check form-check-inline" style="margin: 0; max-width: calc(100% - 113px); display: flex; align-items: center; padding-left: 0.75rem;">
                              <div
                                role="textbox"
                                class="form-control"
                                name="note"
                                id="note"
                                contenteditable
                                placeholder=". . . . . . . . . . . . . . . . . . . . . . . . ."
                              ></div>
                            </div>
                          </div>
                        <!-- <br/> -->
                        <br/>
                        <br/>
                    </div>
                    <!-- <div id="footer" style="border: 1px solid; border-top: unset; display: flex; text-align: center;">
                        <div class="col-3" style="border-right: 1px solid; padding: 0; display: block;">
                            <div style="border-bottom: 1px solid;">Dibuat oleh, </div>
                            <div style="height: 100px; align-content: center;">
                                <input type="text" name="" id="">
                                <input type="button" value="Submit">
                            </div>
                        </div>
                        <div class="col-3" style="border-right: 1px solid; padding: 0; display: block;">
                            <div style="border-bottom: 1px solid;">Disetujui oleh, </div>
                            <div style="height: 100px; align-content: center;">
                                <input type="text" name="" id="">
                                <input type="button" value="Submit">
                            </div>
                        </div>
                        <div class="col-3" style="border-right: 1px solid; padding: 0; display: block;">
                            <div style="border-bottom: 1px solid;">Diterima oleh, </div>
                            <div style="height: 100px; align-content: center;">
                                <input type="text" name="" id="">
                                <input type="button" value="Submit">
                            </div>
                        </div>
                        <div class="col-3" style="padding: 0; display: block;">
                            <div style="border-bottom: 1px solid;">Diterima oleh, </div>
                            <div style="height: 100px; align-content: center;">
                                <input type="text" name="" id="">
                                <input type="button" value="Submit">
                            </div>
                        </div>
                    </div> -->
                    </fieldset>
                </div>
            
                <div id="footer">
                  <div class="col-3" style="border-right: 1px solid; padding: 0; display: block;">
                      <div style="border-bottom: 1px solid;">Dibuat oleh, </div>
                      <!-- <div style="height: 100px; align-content: center;">
                          <input type="text" name="" id="">
                          <input type="button" value="Submit">
                      </div> -->
                      <div id="signature-made-by" name="signature_made_by">
                        <span></span>
                      </div>

                  </div>
                  <div class="col-3" style="border-right: 1px solid; padding: 0; display: block;">
                      <div style="border-bottom: 1px solid;">Disetujui oleh, </div>
                      <div id="signature-approved-by"></div>
                  </div>
                  <div class="col-3" style="border-right: 1px solid; padding: 0; display: block;">
                      <div style="border-bottom: 1px solid;">Diterima oleh, </div>
                      <div id="signature-received-by-1"></div>
                  </div>
                  <div class="col-3" style="padding: 0; display: block;">
                      <div style="border-bottom: 1px solid;">Diterima oleh, </div>
                      <div id="signature-received-by-2"></div>
                  </div>
              </div>
              <div style="margin-top: 4rem; text-align: center;">
                <input class="btn btn-primary" type="submit" value="Submit Form">
              </div>
            </form>
          </div>
        </div>

        <!-- partial:partials/_footer.html -->
        <%- include('./footer.ejs') %>
        <!-- partial -->
      </div>
    </div>

    <!-- core:js -->
    <script src="/vendors/core/core.js"></script>
    <!-- endinject -->
    <!-- plugin js for this page -->
    <!-- jQuery -->
    <script src="/vendors/jSignature/libs/jquery.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.0.min.js"></script>
    <script src="/vendors/jquery.autosize.input/jquery.autosize.input.js"></script>
    <!-- Bootstrap JS -->
    <!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script> -->
    <!-- Bootsrap Msg Js -->
    <!-- <script src="/js/bootstrap-msg.js"></script> -->
    <script src="/vendors/chartjs/Chart.min.js"></script>
    <script src="/vendors/jquery.flot/jquery.flot.js"></script>
    <script src="/vendors/jquery.flot/jquery.flot.resize.js"></script>
    <script src="/vendors/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
    <!-- <script src="https://github.com/jquery/jquery-ui/blob/main/ui/i18n/datepicker-id.js" type='text/javascript'></script> -->
    <script src="/vendors/apexcharts/apexcharts.min.js"></script>
    <script src="/vendors/progressbar.js/progressbar.min.js"></script>
    <!-- <script src="https://select2.github.io/select2/select2-3.5.2/select2.js"></script> -->
    <script src="/vendors/select2/select2.min.js"></script>
    <script src="/vendors/sweetalert2/sweetalert2.min.js"></script>
    <script src="/vendors/promise-polyfill/polyfill.min.js"></script>
    <!-- Optional:  polyfill for ES6 Promises for IE11 and Android browser -->
    <script src="/vendors/moment/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.27.0/locale/id.min.js" integrity="sha512-he8U4ic6kf3kustvJfiERUpojM8barHoz0WYpAUDWQVn61efpm3aVAD8RWL8OloaDDzMZ1gZiubF9OSdYBqHfQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="/vendors/tempusdominus-bootstrap-4/tempusdominus-bootstrap-4.js"></script>
    <script src="/vendors/inputmask/jquery.inputmask.min.js"></script>
    <script src="/vendors/jquery-validation/jquery.validate.min.js"></script>
    <script src="/vendors/jSignature/src/jSignature.js"></script>
    <script src="/vendors/jSignature/src/plugins/jSignature.CompressorBase30.js"></script>
    <script src="/vendors/jSignature/src/plugins/jSignature.CompressorSVG.js"></script>
    <script src="/vendors/jSignature/src/plugins/jSignature.UndoButton.js"></script> 
    <script src="/vendors/jSignature/src/plugins/signhere/jSignature.SignHere.js"></script> 
    <script src="https://willowsystems.github.io/jSignature/js/libs/jSignature.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
    <!-- end plugin js for this page -->
    <!-- inject:js -->
    <script src="/vendors/feather-icons/feather.min.js"></script>
    <script src="/js/template.js"></script>
    <!-- endinject -->
    <!-- custom js for this page -->
    <script src="/js/dashboard.js"></script>
    <!-- <script src="/js/datepicker-id.js" charset="UTF-8"></script> -->
    <!-- <script src="/js/datepicker.js"></script> -->
    <!-- <script src="/js/timepicker.js"></script> -->
    <!-- end custom js for this page -->

    <script>
        $(document).ready(function() {
          var user = <%- JSON.stringify(user) %>;
			    console.log("user in input job order = ", JSON.stringify(user, null, '\t'));
          
          
          // var timeInterval = null;
          var timeInterval = 
            setInterval(function() {
              // $("#signature-made-by span").text(moment().format('DD-MMM-YYYY HH:mm'));
              $("#signature-made-by span").html(`${moment().format('DD-MMM-YYYY')}<br/>${moment().format('HH:mm')}`);
            }, 1000);

          var date = new Date(),
              today = new Date(date.getFullYear(), date.getMonth(), date.getDate()),
              // city,
              city_code,
              // database,
              list_nama_pengirim,
              list_alamat_pengirim,
              list_kontak_pengirim,
              list_nama_penerima,
              list_alamat_penerima,
              list_kontak_penerima,
              list_merk_unit,
              list_tipe_unit,
              // list_nopol_noka_unit,
              list_warna_unit,
              rowIndex
          ;

          // console.log("contentTable in job order = ", JSON.stringify(database, null, '\t'));

          const init_no_joj = <%- JSON.stringify(no_joj) %>;
          // console.log("no_joj in job order = ", no_joj);

          var list_nama_pengirim = <%- JSON.stringify(listNamaPengirim) %>;
          // console.log("list_nama_pengirim in job order = ", JSON.stringify(list_nama_pengirim, null, '\t'));
          
          var list_alamat_pengirim = <%- JSON.stringify(listAlamatPengirim) %>;
          // console.log("list_alamat_pengirim in job order = ", JSON.stringify(list_alamat_pengirim, null, '\t'));

          var list_kontak_pengirim = <%- JSON.stringify(listKontakPengirim) %>;
          // console.log("list_kontak_pengirim in job order = ", JSON.stringify(list_kontak_pengirim, null, '\t'));

          var list_nama_penerima = <%- JSON.stringify(listNamaPenerima) %>;
          // console.log("list_nama_penerima in job order = ", JSON.stringify(list_nama_penerima, null, '\t'));

          var list_alamat_penerima = <%- JSON.stringify(listAlamatPenerima) %>;
          // console.log("list_alamat_penerima in job order = ", JSON.stringify(list_alamat_penerima, null, '\t'));

          var list_kontak_penerima = <%- JSON.stringify(listKontakPenerima) %>;
          // console.log("list_kontak_penerima in job order = ", JSON.stringify(list_kontak_penerima, null, '\t'));

          var list_pengirim_penerima = <%- JSON.stringify(listPengirimPenerima) %>;
          console.log("list_pengirim_penerima in job order = ", JSON.stringify(list_pengirim_penerima, null, '\t'));

          var list_merk_unit = <%- JSON.stringify(listMerkUnit) %>;
          // console.log("list_merk_unit in job order = ", JSON.stringify(list_merk_unit, null, '\t'));

          var list_tipe_unit = <%- JSON.stringify(listTipeUnit) %>;
          // console.log("list_tipe_unit in job order = ", JSON.stringify(list_tipe_unit, null, '\t'));

          var list_warna_unit = <%- JSON.stringify(listWarnaUnit) %>;
          // console.log("list_warna_unit in job order = ", JSON.stringify(list_warna_unit, null, '\t'));

          var new_list_nama_pengirim = [];
          var new_list_alamat_pengirim = [];
          var new_list_kontak_pengirim = [];
          var new_list_nama_penerima = [];
          var new_list_alamat_penerima = [];
          var new_list_kontak_penerima = [];
          var new_list_merk_unit = [];
          var new_list_tipe_unit = [];
          var new_list_warna_unit = [];

          // var list_kondisi = [{index: 1, value: ""}];
          // var list_lainnya = [{index: 1, value: ""}];
          var list_kondisi = [];
          var list_lainnya = [];

          var shortMonths = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
          var phoneExp = /(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?/img;

          $.fn.datepicker.dates['id'] = {
            days: ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"],
            daysShort: ["Min", "Sen", "Sel", "Rab", "Kam", "Jum", "Sab"],
            daysMin: ["Mg", "Sn", "Sl", "Rb", "Km", "Jm", "Sb"],
            months: ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"],
            monthsShort: ["Jan", "Feb", "Mar", "Apr", "Mei", "Jun", "Jul", "Ags", "Sep", "Okt", "Nov", "Des"],
            today: "Hari ini",
            clear: "Clear",
            format: "dd MM yy",
            titleFormat: "MM yyyy", /* Leverages same syntax as 'format' */
            weekStart: 0
          };

          // if (user.role === "Operational") {
          //   $("#nominal-row").hide();
          //   $("#invoice-row").hide();
          //   $("#detail-pembayaran-1").hide();
          // } else {
          //   $("#nominal-row").show();
          //   $("#invoice-row").show();
          //   $("#detail-pembayaran-1").show();
          // }

          if (user.location === "Sidoarjo") {
            city_code = "01";
          } else if (user.location === "Cikarang") {
            city_code = "02";
          } else if (user.location === "Jakarta") {
            city_code = "03";
          } else if (user.location === "Makassar") {
            city_code = "04";
          }

          $("#signature-made-by").bind('change', function(event) {
            $("#signature-made-by canvas").css({
              border: "none",
            });
            $("#sig-error").hide();
            if ($("#signature-made-by").jSignature('getData', 'native').length != 0) {
              $("#signature-made-by span").show();
            } else {
              $("#signature-made-by span").hide();
            }
          });

          const generateTable = async () => {
            // list_kondisi = [{index: 1, value: ""}];
            // list_lainnya = [{index: 1, value: ""}];
            list_kondisi = [];
            list_lainnya = [];
            $("#jo-template #data-kendaraan table tbody").empty();
            for (let index = 1; index <= Number($('#qty').val()); index++) {
              list_kondisi.push({index, value: ""})
              list_lainnya.push({index, value: ""})
              $("#jo-template #data-kendaraan table tbody").append(`
                <tr>
                  <th>${index}</th>
                  <td><select name="merk[${index - 1}]" id="merk-${index}" class="merk form-control"></select></td>
                  <td><select name="tipe[${index - 1}]" id="tipe-${index}" class="tipe form-control" disabled></select></td>
                  <td><input type="text" name="nopol_noka[${index - 1}]" id="nopol_noka-${index}" class="form-control" style="min-width: max-content;" placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ." disabled /></td>
                  <td><select name="warna[${index - 1}]" id="warna-${index}" class="warna form-control" disabled></select></td>
                  <td>
                    <div class="form-group" style="display: flex; margin: 0;">
                      <div class="form-check form-check-inline" 
                        style="
                          margin: 0;
                          margin-right: 0.75rem;
                        ">
                        <label for="status-profit-${index}" class="form-check-label">
                          <input
                            type="radio"
                            class="form-check-input"
                            name="status[${index - 1}]"
                            id="status-profit-${index}"
                            value="profit"
                            required
                            disabled
                          />
                          Profit
                        </label>
                      </div>
                      <div class="form-check form-check-inline" 
                        style="
                          margin: 0;
                          margin-left: 0.75rem;
                        ">
                        <label for="status-second-${index}" class="form-check-label">
                          <input
                            type="radio"
                            class="form-check-input"
                            name="status[${index - 1}]"
                            id="status-second-${index}"
                            value="second"
                            disabled
                          />
                          Second
                        </label>
                      </div>
                    </div>
                    <span class="text-danger" style="display: none;">
                      <label for="status[${index - 1}]" class="error" style="display: none;">Mohon Pilih Status Unit</label>
                    </span>
                    <!-- <label for="status[${index - 1}]" class="error">Mohon Pilih Status Unit</label> -->
                  </td>
                  <td>
                    <div class="form-group" style="display: flex; margin: 0;">
                      <div class="form-check form-check-inline" style="margin: 0; margin-right: 0.75rem;">
                        <label for="kondisi-ada-${index}" class="form-check-label">
                          <input
                            type="radio"
                            class="form-check-input"
                            name="kondisi[${index - 1}]"
                            id="kondisi-ada-${index}"
                            value="ada"
                            disabled
                          />
                          Ada
                        </label>
                      </div>
                      <div class="form-check form-check-inline" style="margin: 0; margin-left: 0.75rem; display: flex; align-items: center; min-width: max-content;">
                        <label for="kondisi-lainnya-${index}" class="form-check-label">
                          <input
                            type="radio"
                            class="form-check-input"
                            name="kondisi[${index - 1}]"
                            id="kondisi-lainnya-${index}"
                            value="lainnya"
                            disabled
                          />
                          Lainnya
                        </label>
                        <input
                          type="text"
                          class="form-control"
                          name="lainnya[${index - 1}]"
                          id="lainnya-${index}"
                          placeholder=". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ."
                          style="margin-left: 0.625rem;"
                          disabled
                        />
                      </div>
                    </div>
                  </td>
                </tr>
              `);
            }

            console.log("list_kondisi after init = ", list_kondisi);
            console.log("list_lainnya after init = ", list_lainnya);

            generateFieldTable();

            // $(".form-check-label").each(function(e) {
            //   console.log(".form-check-label each");
            //   // console.log("child is = ", $(this).children());
            //   // console.log($(this).children().eq(0).attr("type"));
            //   if ($(this).children().eq(0).attr("type") === "radio") {
            //     console.log("is truuee");
            //     console.log($(this).children());
            //     console.log($(this).children().eq(0));
            //     $(this).append('<i class="input-frame"></i>');
            //   }
            // });

            $(".form-check label").append('<i class="input-frame"></i>');

            // checkbox and radios
            // $(".form-check label, .form-radio label").append('<i class="input-frame"></i>');
          };

          const generateFieldTable = async () => {
            $(`[name^="merk"]`).append(`<option></option>`);
            list_merk_unit.forEach(merk => {
                $(`[name^="merk"]`).append(`<option value="${merk}">${merk}</option>`);
            });

            $(`[name^="merk"]`).val(null);

            $(`[name^="merk"]`).select2({
                placeholder: "PILIH SALAH SATU",
                allowClear: true,
                width: "style",
                tags: true,
                closeOnSelect: true,
                minimumInputLength: 3,
            });

            $('[name^="merk"]').on("change", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];
              
              // console.log("rowIndex merk is = ", rowIndex);

              // console.log(`[name="merk[]"] at index ${rowIndex} change value is = `, this.value);
              
              $(`[name="tipe[${rowIndex}]"]`).prop('disabled', !this.value);

              $(this).trigger('blur');
            }).on("blur", function(event) {
              console.log(`on blur this value merk at ${rowIndex} = `, this.value);
            }).on("select2:opening", function(e) {
              if ($(this).data('unselecting')) {
                $(this).removeData('unselecting');
                $(`[name="tipe[${rowIndex}]"]`).val(null).trigger('change');
                $(`[name="nopol_noka[${rowIndex}]"]`).val(null).trigger('change');
                $(`[name="warna[${rowIndex}]"]`).val(null).trigger('change');
                $(`[name="status[${rowIndex}]"]`).prop('checked', false);
                $(`[name="kondisi[${rowIndex}]"]`).prop('checked', false);
                $(`[name="lainnya[${rowIndex}]"]`).val(null).trigger('change');

                $(`[name="tipe[${rowIndex}]"]`).prop('disabled', true);
                $(`[name="nopol_noka[${rowIndex}]"]`).prop('disabled', true);
                $(`[name="warna[${rowIndex}]"]`).prop('disabled', true);
                $(`[name="status[${rowIndex}]"]`).prop('disabled', true);
                $(`[name="kondisi[${rowIndex}]"]`).prop('disabled', true);
                $(`[name="lainnya[${rowIndex}]"]`).prop('disabled', true);

                $(`[name="status[${rowIndex}]"]`).parents(".form-group").siblings(".text-danger").children().css({
                  display: "none",
                });
                e.preventDefault();
              }
            }).on("select2:unselecting", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];
              $(this).data('unselecting', true);
            }).on("select2:select", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];
              // console.log(`[name="merk[]"] at index ${rowIndex} select value is = `, this.value);

              if (list_merk_unit.findIndex(merk => String(this.value).toLowerCase() === String(merk).toLowerCase()) === -1) {
                console.log(`merk at ${rowIndex} with ${this.value} is added`);
                new_list_merk_unit.push(this.value);
                list_merk_unit.push(this.value);
                $(this).append(new Option(this.value, this.value, true, true));
              }
            });

            $('[name^="merk"]').each(function(e) {
              $(this).rules('add', {
                required: true,
                messages: {
                  required: "Mohon Isi Field Merk Unit",
                },
              });
            });

            $(`[name^="tipe"]`).append(`<option></option>`);
            list_tipe_unit.forEach(tipe => {
                $(`[name^="tipe"]`).append(`<option value="${tipe}">${tipe}</option>`);
            });

            $(`[name^="tipe"]`).val(null);

            // $(`[name^="tipe"]`).val("jie83jwjd");

            $(`[name^="tipe"]`).select2({
                placeholder: "PILIH SALAH SATU",
                allowClear: true,
                width: "style",
                tags: true,
                closeOnSelect: true,
                minimumInputLength: 3, 
              //   language: {
              //     inputTooShort: function(args) {
              //         // return "";
              //         // args.input = args.input || $(this).data('select2').dropdown.$search.val();
              //         // rowIndex = $(this).attr("name").match(/\d+/)[0];
              // // console.log(`[name="tipe[]"] at index ${rowIndex} select value is = `, this.value);
              // // console.log(`select2 select value is = `, this.value);
              // // console.log($(this));
              // // $(this).select2("search", this.value);
              // // name="tipe[1]"
              // // $(this).select2("search", "this value 63qe7daggsag");
              // // $(`[name="tipe[${rowIndex}]"]`).select2("search", "this value 63qe7daggsag");
              //         console.log("language inputTooShort");
              //         console.log($(this).val());
              //         // console.log($(`[name="tipe[${rowIndex}]"]`).val());
              //         console.log("args = ", args);
              //         console.log("args minimum = ", args.minimum);
              //         console.log("args input = ", args.input);
              //         // console.log("this dropdown.$search.val = ", $(this).data('select2').dropdown.$search.val());
              //         // if ($(this).data('select2').dropdown.$search.val() >= args.minimum) {
              //         //   return false
              //         // }
              //     }
              //   },
            });

            $('[name^="tipe"]').on("change", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];
              
              // console.log("rowIndex tipe is = ", rowIndex);

              // console.log(`[name="tipe[]"] at index ${rowIndex} change value is = `, this.value);

              // console.log("merk in tipe event = ", $(`[name="merk[${rowIndex}]"]`).val());

              $(`[name="status[${rowIndex}]"]`).prop('disabled', !$(`[name="merk[${rowIndex}]"]`).val() || !this.value);

              $(this).trigger('blur');
            }).on("blur", function(event) {
              console.log(`on blur this value tipe at ${rowIndex} = `, this.value);
              $(this).data('select2').dropdown.$search.val(this.value);
              // $(this).data('select2').selection.$search.val(this.value);
            }).on("select2:opening", function(e) {
              console.log("tipe select 2 opening value is = ", this.value);
              console.log($(this).data('select2').dropdown);
              $(this).data('select2').dropdown.$search.val(this.value);
              // $(this).data('select2').selection.$search.val(this.value);
              if ($(this).data('unselecting')) {
                $(this).removeData('unselecting');
                $(`[name="nopol_noka[${rowIndex}]"]`).val(null).trigger('change');
                $(`[name="warna[${rowIndex}]"]`).val(null).trigger('change');
                $(`[name="status[${rowIndex}]"]`).prop('checked', false);
                $(`[name="kondisi[${rowIndex}]"]`).prop('checked', false);
                $(`[name="lainnya[${rowIndex}]"]`).val(null).trigger('change');

                $(`[name="nopol_noka[${rowIndex}]"]`).prop('disabled', true);
                $(`[name="warna[${rowIndex}]"]`).prop('disabled', true);
                $(`[name="status[${rowIndex}]"]`).prop('disabled', true);
                $(`[name="kondisi[${rowIndex}]"]`).prop('disabled', true);
                $(`[name="lainnya[${rowIndex}]"]`).prop('disabled', true);

                $(`[name="status[${rowIndex}]"]`).parents(".form-group").siblings(".text-danger").children().css({
                  display: "none",
                });
                e.preventDefault();
              }
              
              // $(this).select2("search", this.value);
            }).on("select2:open", function(e) {
              // $(this).select2("search", "Ertiga");
              console.log("tipe select 2 open val is = ", this.value);
              // $(this).data('select2').dropdown.$search.val(this.value);
            }).on("select2:unselecting", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];
              $(this).data('unselecting', true);
            }).on("select2:select", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];
              // console.log(`[name="tipe[]"] at index ${rowIndex} select value is = `, this.value);
              console.log(`select2 select value is = `, this.value);
              // console.log($(this));
              // $(this).select2("search", this.value);
              // name="tipe[1]"
              // $(this).select2("search", "this value 63qe7daggsag");
              // $(`[name="tipe[${rowIndex}]"]`).select2("search", "this value 63qe7daggsag");

              if (list_tipe_unit.findIndex(tipe => String(this.value).toLowerCase() === String(tipe).toLowerCase()) === -1) {
                console.log(`tipe at ${rowIndex} with ${this.value} is added`);
                new_list_tipe_unit.push(this.value);
                list_tipe_unit.push(this.value);
                $(this).append(new Option(this.value, this.value, true, true));
              }
            }).on("select2:closing", function(e) {
              console.log("tipe select 2 closing val is = ", this.value);
              console.log($(this).data('select2').dropdown);
              $(this).data('select2').dropdown.$search.val(this.value);
            }).on("select2:close", function(e) {
              console.log("tipe select 2 close val is = ", this.value);
              console.log($(this).data('select2').dropdown);
              $(this).data('select2').dropdown.$search.val(this.value);
            });

            $('[name^="tipe"]').each(function(e) {
              $(this).rules('add', {
                required: true,
                messages: {
                  required: "Mohon Isi Field Type Unit",
                  
                },
              });
            });

            $(`[name^="warna"]`).append(`<option></option>`);
            list_warna_unit.forEach(warna => {
                $(`[name^="warna"]`).append(`<option value="${warna}">${warna}</option>`);
            });

            $(`[name^="warna"]`).val(null);

            $(`[name^="warna"]`).select2({
                placeholder: "PILIH SALAH SATU",
                allowClear: true,
                width: "style",
                tags: true,
            });

            $('[name^="warna"]').on("change", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];

              $(this).trigger('blur');
            }).on("blur", function(event) {
              console.log(`on blur this value warna at ${rowIndex} = `, this.value);
              $(this).data('select2').dropdown.$search.val(this.value);
            }).on("select2:opening", function(e) {
              $(this).data('select2').dropdown.$search.val(this.value);
              if ($(this).data('unselecting')) {
                $(this).removeData('unselecting');
                e.preventDefault();
              }
            }).on("select2:unselecting", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];
              $(this).data('unselecting', true);
            }).on("select2:select", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];
              
              if (list_warna_unit.findIndex(warna => String(this.value).toLowerCase() === String(warna).toLowerCase()) === -1) {
                console.log(`warna at ${rowIndex} with ${this.value} is added`);
                new_list_warna_unit.push(this.value);
                list_warna_unit.push(this.value);
                $(this).append(new Option(this.value, this.value, true, true));
              }
            });

            $("[name^='status']").on("click", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];

              $(`[name="nopol_noka[${rowIndex}]"]`).prop('disabled', false);
              $(`[name="warna[${rowIndex}]"]`).prop('disabled', false);
              $(`[name="kondisi[${rowIndex}]"]`).prop('disabled', false);
            });

            $('[name^="status"]').each(function(e) {
              console.log("each status = ", $(this));
              $(this).rules('add', {
                required: true,
                messages: {
                  required: "Mohon Pilih Status Unit",
                },
              });
            });

            $("[name^='kondisi']").on("click", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];
              list_kondisi[list_kondisi.findIndex(obj => obj.index - 1 == rowIndex)].value = this.value
              if (this.value !== "lainnya") {
                $(`[name="lainnya[${rowIndex}]"]`).val("");
                list_lainnya[list_lainnya.findIndex(obj => obj.index - 1 == rowIndex)].value = ""
              }
              $(`[name="lainnya[${rowIndex}]"]`).prop('disabled', !(this.value === "lainnya"));
              // console.log("list_kondisi after choose kondisi = ", JSON.stringify(list_kondisi, null, '\t'));
              // console.log("list_lainnya after input lainnya = ", JSON.stringify(list_lainnya, null, '\t'));
            });
            
            $("[name^='lainnya']").on("input", function(e) {
              rowIndex = $(this).attr("name").match(/\d+/)[0];
              list_lainnya[list_lainnya.findIndex(obj => obj.index - 1 == rowIndex)].value = this.value
              // console.log("list_lainnya after input lainnya = ", JSON.stringify(list_lainnya, null, '\t'));
            });
          };

          // $('#hr_tgl_ambil').datepicker('option', 'onSelect', function(dateText, inst) { 
          //     alert( $(this).datepicker('getDate'))
          //     alert( dateText)
          //       alert( inst)
          //    });

          const loadData = async () => {
            $("#jo-template #content > #header div:nth-child(1) h6").text(`${user.location}, ${moment(new Date()).format('DD MMMM YYYY')}`.toUpperCase());

            $("#jo-template #content > #header div:nth-child(2) span").html(`No. JO : ${city_code + String(moment(new Date()).format('YY'))}<span id="no_joj" contenteditable="true">${String(init_no_joj).padStart(6, '0')}</span>`);

            $("#no_joj").inputmask({
              mask: "999999",
              autoUnmask: false,
              showMaskOnHover: false,
              rightAlign: true,
              placeholder: "000000",
            });

            $('#no_joj').on("blur", function() {
              if (!this.value) {
                this.value = 0;
              }
            });

            $(`#hr_tgl_ambil`).datepicker({
              format: "DD / dd MM yyyy",
              language: "id",
              startDate: today,
              todayHighlight: true,
              autoclose: true,
            })
//             .on("changeDate", function (e) {
//               alert( $(this).datepicker('getDate'))
// });

            // $(`#hr_tgl_ambil`).datepicker({
            //   onSelect: function(dateText, inst) {
            //     alert( $(this).datepicker('getDate'))
            //     alert( dateText)
            //     alert( inst)
            //   }
            // });

            // $('#hr_tgl_ambil').on("change", function(e) {
            //   alert( $(this).datepicker('getDate'))
            // });

            // $('#hr_tgl_ambil').datepicker('option', 'onSelect', function(dateText, inst) { 
            //   alert( $(this).datepicker('getDate'))
            //   alert( dateText)
            //     alert( inst)
            //  });

            // console.log($.datepicker.formatDate('DD / dd MM yyyy',  $("#hr_tgl_ambil").datepicker('getDate')));

            $("#hr_tgl_ambil").datepicker('setDate', new Date());

            // console.log($('#hr_tgl_ambil').val());

            $(`#nama_pengirim`).append(`<option></option>`);
            list_nama_pengirim.forEach(nama_pengirim => {
                $(`#nama_pengirim`).append(`<option value="${nama_pengirim}">${nama_pengirim}</option>`);
            });
            list_pengirim_penerima.forEach(pengirim_penerima => {
                $(`#nama_pengirim`).append(`<option value="${pengirim_penerima.keyword}">${pengirim_penerima.keyword}</option>`);
            });

            $(`#nama_pengirim`).val(null);

            // let datasetInput = false;
            var datasetIndex = -1, datasetAlamat, datasetKontak;

            /*
            * When you change the value the select via select2, it triggers
            * a 'change' event, but the jquery validation plugin
            * only re-validates on 'blur'
            */

            $(`#nama_pengirim`).select2({
                placeholder: "PILIH SALAH SATU",
                allowClear: true,
                width: "style",
                tags: true,
                minimumInputLength: 3,
                closeOnSelect: true,
                dropdownAutoWidth : true,
            }).on("change", function(event) {
              console.log("on change this value nama pengirim = ", this.value);

              $(this).trigger('blur');

              // console.log("is datasetInput inside nama pengirim = ", datasetInput);
              console.log("datasetIndex inside nama pengirim = ", datasetIndex);

              $('#alamat_pengirim').prop('disabled', !this.value);

              // $(`#nama_pengirim`).parent().removeClass('has-danger');
              // $(`#nama_pengirim`).removeClass('form-control-danger');
              // $("label.error.text-danger").remove();
            }).on("blur", function(event) {
              console.log("on blur this value nama pengirim = ", this.value);
            }).on("select2:unselecting", function(e) {
              console.log("select2 unselecting");
              console.log("select unselecting value nama pengirim = ", this.value);

              datasetIndex = -1;

              $(`#alamat_pengirim`).val(null).trigger('change');
              $(`#alamat_pengirim`).parent().removeClass('has-danger');
              $(`#alamat_pengirim`).removeClass('form-control-danger');
              $(`#alamat_pengirim-error`).remove();

              $(`#kontak_pengirim`).val(null).trigger('change');
              $(`#kontak_pengirim`).parent().removeClass('has-danger');
              $(`#kontak_pengirim`).removeClass('form-control-danger');
              $(`#kontak_pengirim-error`).remove();
              
              $(this).on("select2:opening", function (evt) {
                evt.preventDefault();
                $(this).off("select2:opening");
              });
            }).on("select2:select", function(e) {
              console.log("select2 select");
              console.log("select input value nama pengirim = ", this.value);

              datasetIndex = list_pengirim_penerima.findIndex(pengirim_penerima => String(this.value).toLowerCase() === String(pengirim_penerima.keyword).toLowerCase());
              if (datasetIndex !== -1) {
                console.log("dataset index is at = ", datasetIndex);
                console.log("dataset by index iss = ", list_pengirim_penerima[datasetIndex]);
                // datasetInput = true;
                // console.log("is datasetInput inside chosen selected dataset = ", datasetInput);
                console.log("dataset nama = ", list_pengirim_penerima[datasetIndex]["nama"]);
                $(this).val(String(list_pengirim_penerima[datasetIndex].nama)).trigger('change');

                $('#alamat_pengirim').prop('disabled', false);
                console.log("dataset alamat = ", list_pengirim_penerima[datasetIndex]["alamat"]);
                datasetAlamat = list_pengirim_penerima[datasetIndex]["alamat"];
                console.log("datasetAlamat is before = ", datasetAlamat);
                $(`#alamat_pengirim`).val(String(list_pengirim_penerima[datasetIndex]["alamat"])).trigger('change');

                $('#kontak_pengirim').prop('disabled', false);
                console.log("dataset kontak = ", list_pengirim_penerima[datasetIndex]["kontak"]);
                $(`#kontak_pengirim`).val(String(list_pengirim_penerima[datasetIndex]["kontak"])).trigger('change');
              } else {
                if (list_nama_pengirim.findIndex(nama_pengirim => String(this.value).toLowerCase() === String(nama_pengirim).toLowerCase()) === -1) {
                  console.log(this.value, "added to dataset");
                  new_list_nama_pengirim.push(this.value);
                  list_nama_pengirim.push(this.value);
                  $(this).append(new Option(this.value, this.value, true, true));
                }
              }
            });

            // Add this: clear all options when select2 has initialized
            // if ($('.nama_pengirim.fix').hasClass("select2-hidden-accessible")) {
            //     $('.nama_pengirim.fix').val(null).trigger('change');
            // }

            $(`#alamat_pengirim`).append(`<option></option>`);
            list_alamat_pengirim.forEach(alamat_pengirim => {
                $(`#alamat_pengirim`).append(`<option value="${alamat_pengirim}">${alamat_pengirim}</option>`);
            });

            $(`#alamat_pengirim`).val(null);

            $(`#alamat_pengirim`).select2({
                placeholder: "PILIH SALAH SATU",
                allowClear: true,
                width: "style",
                tags: true,
                closeOnSelect: true,
                dropdownAutoWidth : true,
                // minimumInputLength: 3,
            }).on("change", function(event) {
              if (datasetIndex !== -1) {
                console.log("event", event);
                console.log("alamat has dataset");
                this.value = list_pengirim_penerima[datasetIndex].alamat
                this.value = datasetAlamat
              }
              console.log("on change this value alamat pengirim = ", this.value);
              console.log("on change this value 2 alamat pengirim = ", String(this.value));

              $(this).trigger('blur');

              // console.log("is datasetInput inside alamat pengirim = ", datasetInput);
              console.log("datasetIndex inside alamat pengirim = ", datasetIndex);

              // if (!datasetInput) {
              //   $('#kontak_pengirim').prop('disabled', !$('#nama_pengirim').val() || !this.value);
              // }

              console.log("list_pengirim_penerima[datasetIndex].alamat inside alamat pengirim = ", list_pengirim_penerima[datasetIndex].alamat);

              console.log("if datasetIndex first = ", datasetIndex !== -1);

              console.log("result conditional if inside alamat pengirim = ", (datasetIndex !== -1 && list_pengirim_penerima[datasetIndex].alamat));

              // if (datasetIndex !== -1 && list_pengirim_penerima[datasetIndex].alamat) {
              if (datasetIndex !== -1) {
                // console.log("");
                $(this).val(list_pengirim_penerima[datasetIndex].alamat).trigger('change.select2');
                console.log("datasetAlamat after is = ", datasetAlamat);
                $(this).val(datasetAlamat).trigger('change.select2');
              } else {
                $('#kontak_pengirim').prop('disabled', !$('#nama_pengirim').val() || !this.value);
              }
              
              // $(`#alamat_pengirim`).parent().removeClass('has-danger');
              // $(`#alamat_pengirim`).removeClass('form-control-danger');
              // $("label.error.text-danger").remove();
            }).on("blur", function(event) {
              console.log("on blur this value alamat pengirim = ", this.value);
            }).on("select2:unselecting", function(e) {
              console.log("select2 unselecting");
              console.log("select unselecting value alamat pengirim = ", this.value);

              $(`#kontak_pengirim`).val(null).trigger('change');
              $(`#kontak_pengirim`).parent().removeClass('has-danger');
              $(`#kontak_pengirim`).removeClass('form-control-danger');
              $(`#kontak_pengirim-error`).remove();
              
              $(this).on("select2:opening", function (evt) {
                evt.preventDefault();
                $(this).off("select2:opening");
              });
            }).on("select2:select", function(e) {
              console.log("select2 select");
              console.log("select input value alamat pengirim = ", this.value);

              if (list_alamat_pengirim.findIndex(alamat_pengirim => String(this.value).toLowerCase() === String(alamat_pengirim).toLowerCase()) === -1) {
                console.log(this.value, "added to dataset");
                new_list_alamat_pengirim.push(this.value);
                list_alamat_pengirim.push(this.value);
                $(this).append(new Option(this.value, this.value, true, true));
              }
            });

            $(`#kontak_pengirim`).append(`<option></option>`);
            list_kontak_pengirim.forEach(kontak_pengirim => {
                $(`#kontak_pengirim`).append(`<option value="${kontak_pengirim}">${kontak_pengirim}</option>`);
            });

            $(`#kontak_pengirim`).val(null);

            $(`#kontak_pengirim`).select2({
                placeholder: "PILIH SALAH SATU",
                allowClear: true,
                width: "style",
                tags: true,
                closeOnSelect: true,
            }).on("change", function(event) {
              if (datasetIndex !== -1) this.value = list_pengirim_penerima[datasetIndex].kontak
              console.log("on change this value kontak pengirim = ", this.value);

              // console.log("is datasetInput inside kontak pengirim = ", datasetInput);

              $(this).trigger('blur');

              // if (datasetInput) datasetInput = false;

              console.log("datasetIndex inside kontak pengirim = ", datasetIndex);

              if (datasetIndex !== -1 && list_pengirim_penerima[datasetIndex].kontak) {
                $(this).val(list_pengirim_penerima[datasetIndex].kontak).trigger('change.select2');
                datasetIndex = -1;
              }
              
              // $(`#kontak_pengirim`).parent().removeClass('has-danger');
              // $(`#kontak_pengirim`).removeClass('form-control-danger');
              // $("label.error.text-danger").remove();
            }).on("blur", function(event) {
              console.log("on blur this value kontak pengirim = ", this.value);
            }).on("select2:unselecting", function(e) {
              console.log("select2 unselecting");
              console.log("select unselecting value kontak pengirim = ", this.value);
              
              $(this).on("select2:opening", function (evt) {
                evt.preventDefault();
                $(this).off("select2:opening");
              });
            }).on("select2:select", function(e) {
              console.log("select2 select");
              console.log("select input value kontak pengirim = ", this.value);

              if (list_kontak_pengirim.findIndex(kontak_pengirim => String(this.value).toLowerCase() === String(kontak_pengirim).toLowerCase()) === -1) {
                console.log(this.value, "added to dataset");
                new_list_kontak_pengirim.push(this.value);
                list_kontak_pengirim.push(this.value);
                $(this).append(new Option(this.value, this.value, true, true));
              }
            });

            // $("#e1").val("B1").select2();
            // $("#e1").on("select2-opening", function() { 
            //   $("#e1").on("select2-open", function() { 
            //     $(this).select2("search","BB234798132786wq8sdaB");
            //   });
            // })

            $(`#nama_penerima`).append(`<option value=""></option>`);
            list_nama_penerima.forEach(nama_penerima => {
                $(`#nama_penerima`).append(`<option value="${nama_penerima}">${nama_penerima}</option>`);
            });

            // $(`#nama_penerima`).val(null);

            // $(`#nama_penerima`).val("3829jadfrgugs sadf adsr24").trigger('change');

            $(`#nama_penerima`).select2({
                placeholder: "PILIH SALAH SATU",
                allowClear: true,
                width: "style",
                tags: true,
                closeOnSelect: true,
                minimumInputLength: 3,
            }).on("change", function(event) {
              console.log("on change this value nama penerima = ", this.value);

              $(this).trigger('blur');

              $('#alamat_penerima').prop('disabled', !this.value);

              // $(`#nama_penerima`).parent().removeClass('has-danger');
              // $(`#nama_penerima`).removeClass('form-control-danger');
              // $("label.error.text-danger").remove();
            }).on("blur", function(event) {
              console.log("on blur this value nama penerima = ", this.value);
            }).on("select2:unselecting", function(e) {
              console.log("select2 unselecting");
              console.log("select unselecting value nama penerima = ", this.value);

              $(`#alamat_penerima`).val(null).trigger('change');
              $(`#alamat_penerima`).parent().removeClass('has-danger');
              $(`#alamat_penerima`).removeClass('form-control-danger');
              $(`#alamat_penerima-error`).remove();

              $(`#kontak_penerima`).val(null).trigger('change');
              $(`#kontak_penerima`).parent().removeClass('has-danger');
              $(`#kontak_penerima`).removeClass('form-control-danger');
              $(`#kontak_penerima-error`).remove();
              
              $(this).on("select2:opening", function (evt) {
                evt.preventDefault();
                $(this).off("select2:opening");
              });
            }).on("select2:select", function(e) {
              console.log("select2 select");
              console.log("select input value nama penerima = ", this.value);

              if (list_nama_penerima.findIndex(nama_penerima => String(this.value).toLowerCase() === String(nama_penerima).toLowerCase()) === -1) {
                console.log(this.value, "added to dataset");
                new_list_nama_penerima.push(this.value);
                list_nama_penerima.push(this.value);
                $(this).append(new Option(this.value, this.value, true, true));
              }
            });

            // $(`#nama_penerima`).val("3829jadfrgugs sadf adsr24").trigger('change');
            // $(`#nama_penerima`).val("UMC Surabaya");
            // $(`#nama_penerima`).val("UMC Surabaya").trigger('change');

            // alert($(`#nama_penerima`).val())

            $(`#alamat_penerima`).append(`<option value=""></option>`);
            list_alamat_penerima.forEach(alamat_penerima => {
                $(`#alamat_penerima`).append(`<option value="${alamat_penerima}">${alamat_penerima}</option>`);
            });

            $(`#alamat_penerima`).val(null);

            $(`#alamat_penerima`).select2({
                placeholder: "PILIH SALAH SATU",
                allowClear: true,
                width: "style",
                tags: true,
                closeOnSelect: true,
                // minimumInputLength: 3,
            }).on("change", function(event) {
              $(this).trigger('blur');

              $('#kontak_penerima').prop('disabled', !$('#nama_penerima').val() || !this.value);

              // $(`#alamat_penerima`).parent().removeClass('has-danger');
              // $(`#alamat_penerima`).removeClass('form-control-danger');
              // $("label.error.text-danger").remove();
            }).on("blur", function(event) {
              console.log("on blur this value alamat penerima = ", this.value);
            }).on("select2:unselecting", function(e) {
              console.log("select2 unselecting");
              console.log("select unselecting value alamat penerima = ", this.value);
              
              $(`#kontak_penerima`).val(null).trigger('change');
              $(`#kontak_penerima`).parent().removeClass('has-danger');
              $(`#kontak_penerima`).removeClass('form-control-danger');
              $(`#kontak_penerima-error`).remove();

              $(this).on("select2:opening", function (evt) {
                evt.preventDefault();
                $(this).off("select2:opening");
              });
            }).on("select2:select", function(e) {
              console.log("select2 select");
              console.log("select input value alamat penerima = ", this.value);

              if (list_alamat_penerima.findIndex(alamat_penerima => String(this.value).toLowerCase() === String(alamat_penerima).toLowerCase()) === -1) {
                console.log(this.value, "added to dataset");
                new_list_alamat_penerima.push(this.value);
                list_alamat_penerima.push(this.value);
                $(this).append(new Option(this.value, this.value, true, true));
              }
            });

            $(`#kontak_penerima`).append(`<option></option>`);
            list_kontak_penerima.forEach(kontak_penerima => {
                $(`#kontak_penerima`).append(`<option value="${kontak_penerima}">${kontak_penerima}</option>`);
            });

            $(`#kontak_penerima`).val(null);

            $(`#kontak_penerima`).select2({
                placeholder: "PILIH SALAH SATU",
                allowClear: true,
                width: "style",
                tags: true,
                closeOnSelect: true,
            }).on("change", function(event) {
              $(this).trigger('blur');

              // $(`#kontak_penerima`).parent().removeClass('has-danger');
              // $(`#kontak_penerima`).removeClass('form-control-danger');
              // $("label.error.text-danger").remove();
            }).on("blur", function(event) {
              console.log("on blur this value kontak penerima = ", this.value);
            }).on("select2:unselecting", function(e) {
              console.log("select2 unselecting");
              console.log("select unselecting value kontak penerima = ", this.value);
              
              $(this).on("select2:opening", function (evt) {
                evt.preventDefault();
                $(this).off("select2:opening");
              });
            }).on("select2:select", function(e) {
              console.log("select2 select");
              console.log("select input value kontak penerima = ", this.value);

              if (list_kontak_penerima.findIndex(kontak_penerima => String(this.value).toLowerCase() === String(kontak_penerima).toLowerCase()) === -1) {
                console.log(this.value, "added to dataset");
                new_list_kontak_penerima.push(this.value);
                list_kontak_penerima.push(this.value);
                $(this).append(new Option(this.value, this.value, true, true));
              }
            });

            $("#jo-form").validate({
              wrapper: "span",
              ignore: 'input[type=hidden], .select2-input, .select2-focusser',
              rules: {
                nama_pengirim: {
                  required: true,
                },
                alamat_pengirim: {
                  required: true,
                },
                kontak_pengirim: {
                  required: true,
                },
                nama_penerima: {
                  required: true,
                  // minlength: 3,
                },
                alamat_penerima: {
                  required: true,
                },
                kontak_penerima: {
                  required: true,
                },
              },
              messages: {
                nama_pengirim: {
                  required: "Mohon Isi Field Nama Pengirim",
                },
                alamat_pengirim: {
                  required: "Mohon Isi Field Alamat Pengirim",
                },
                kontak_pengirim: {
                  required: "Mohon Isi Field Kontak Pengirim",
                },
                nama_penerima: {
                  required: "Mohon Isi Field Nama Penerima",
                  // minlength: "Field Nama Penerima harus terdiri dari minimal {0} karakter",
                },
                alamat_penerima: {
                  required: "Mohon Isi Field Alamat Penerima",
                },
                kontak_penerima: {
                  required: "Mohon Isi Field Kontak Penerima",
                },
              },
              errorPlacement: function(label, element) {
                label.insertAfter(element.next('.select2-container')).addClass('text-danger');
                // console.log("select2label_nama_pengirim errorPlacement before = ", select2label_nama_pengirim);
                // select2label_nama_pengirim = label;
                // console.log("select2label_nama_pengirim errorPlacement after = ", select2label_nama_pengirim);
                // select2_invalid_nama_pengirim = label;
              },
              highlight: function(element, errorClass) {
                $(element).parent().addClass('has-danger');
                $(element).addClass('form-control-danger');
              },
              // unhighlight: function(label, element) {
              //   $(element).parent().removeClass('has-danger');
              //   $(element).removeClass('form-control-danger');
              //   label.remove();
              // },
              success: function(label, element) {
                $(element).parent().removeClass('has-danger');
                $(element).removeClass('form-control-danger');
                label.remove();
              },
            });

            // generateFieldTable();

            await generateTable();

            // $(".spinner-border").hide();

            // $("#jo-template").show();

            $(`#signature-made-by`).jSignature({
              'UndoButton': true,
              'decor-color': 'transparent',
              'color': '#000',
              'width': '100%',
              'height': '100',
              'lineWidth': 1,
            });

            $("#signature-made-by").append("<p class='error text-danger' id='sig-error' style='display: none;'>Mohon Tanda Tangan Field Dibuat Oleh</p>" );

            $("#nominal, #nominal_handling, #keterangan_biaya_koord").inputmask({
              alias: "currency",
              prefix: "Rp",
              groupSeparator: ".",
              radixPoint: ",",
              digits: '0',
              rightAlign: false,
              allowPlus: false,
              allowMinus: false,
            });

            $("#nominal").on("input", function() {
              console.log("nominal value is = ", this.value);
            });

            // To change defaults and be used it has to happen before the instance is initialized
            // Remove the data attribute to test this
            //Plugins.AutosizeInput.getDefaultOptions().space = 60;
            
            $("#nominal").autosizeInput();
            $("#moda").autosizeInput();
            $("#invoice").autosizeInput();

            $("#note").focusout(function(){
              if (!$(this).text().replace(" ", "").length) {
                $(this).empty();
              }
            });


            $("#tagihan_top").on("input", function() {
              if (this.value.length === 0) {
              // if (Number((this.value).replace(/,|\Rp/g, '')) === 0) {
                $("div#opsi_tagihan_top").hide();
              } else {
                $("div#opsi_tagihan_top").show();
              }
              $("#detail-pembayaran-1 .form-check:nth-child(3).col-6").css({
                "padding-left": Number((this.value).replace(/,|\Rp/g, '')) === 0 ? "1rem" : 0,
              });
            });

            $(".minus").on("click", function() {
              $('#qty').val(Number($('#qty').val()) - 1);
              if (Number($('#qty').val()) === 1) {
                $(".minus").prop('disabled', true);
              }
              generateTable();
            });

            $(".plus").on("click", function() {
              $('#qty').val(Number($('#qty').val()) + 1);
              if (Number($('#qty').val()) > 1) {
                $(".minus").prop('disabled', false);
              }
              generateTable();
            });

            $("#qty, #tagihan_top").keypress( function (event) {
              let charCode = (event.which) ? event.which : event.keyCode;
              if (charCode > 31 && (charCode < 48 || charCode > 57)) {
                  return false;
              }
            });

            $('#qty').on("input", function() {
              if (Number(this.value) === 0 || !this.value) {
                // console.log("input qty is not validd");
                this.value = 1;
              }
              this.style.width = 1.2 * this.value.length + "ch";
              $(".minus").prop('disabled', Number(this.value) === 1);
              generateTable();
            });

            $("input:radio[name='tagihan']").on("click", function() {
              console.log("tagihan value = ", $(this).val());
              $("#tagihan_top").removeAttr("disabled");
            });

            $("input:radio[name='asuransi']").on("click", function() {
              console.log("asuransi value = ", $(this).val());
              if ($(this).val() === "ada") {
                $("#perincian_asuransi").removeAttr("disabled");
              } else {
                $("#perincian_asuransi").val("");
                $("#perincian_asuransi").attr("disabled", "disabled");
              }
            });

            $("input:radio[name='biaya_koord']").on("click", function() {
              console.log("biaya_koord value = ", $(this).val());
              if ($(this).val() === "ada") {
                $("#keterangan_biaya_koord").removeAttr("disabled");
              } else {
                $("#keterangan_biaya_koord").val("");
                $("#keterangan_biaya_koord").attr("disabled", "disabled");
              }
            });

            $("input:radio[name='penawaran_kontrak']").on("click", function() {
              console.log("penawaran_kontrak value = ", $(this).val());
              if ($(this).val() === "ada") {
                $(this).parents("div.form-group.form-row").css("height", "unset");
                $('input:radio[name="opsi_penawaran_kontrak"][value="surat_penawaran"]').prop('checked', true);
                $("#no_opsi_penawaran_kontrak").val("");
                $("div#opsi_penawaran_kontrak").show();
                $("div#opsi_penawaran_kontrak").css({
                  display: "grid",
                  gap: "0.5rem",
                  margin: 0,
                  marginLeft: "1rem",
                  // marginTop: "0.5rem",
                });
              } else {
                $(this).parents("div.form-group.form-row").css("height", "2.1875rem");
                $("div#opsi_penawaran_kontrak").hide();
                $("div#opsi_penawaran_kontrak").css({
                  display: "none",
                });
              }
            });

            $("input:radio[name='handling']").on("click", function() {
              console.log("handling value = ", $(this).val());
              // $("#tagihan_top").removeAttr("disabled");
              if ($(this).val() === "ada") {
                $(this).parents("div.form-group.form-row").css("height", "unset");
                $("#nominal_handling").val("");
                $("#nama_penerima_handling").val("");
                $("#form_handling").show();
                $("#form_handling").css({
                  display: "grid",
                  gap: "0.5rem",
                  margin: 0,
                  marginLeft: "1rem",
                  // marginTop: "0.5rem",
                });
              } else {
                $("#form_handling").hide();
              }
            });
          };

          loadData();
          // generateTable();

          $(".spinner-border").hide();

          $("#jo-template").show();

          // function render(templateId, data) {
          //   // Get the template content
          //   var template = document.getElementById(templateId).innerHTML;

          //   // Replace placeholders in the template with actual data
          //   for (var key in data) {
          //       var regex = new RegExp('{{\\s*' + key + '\\s*}}', 'g');
          //       template = template.replace(regex, data[key]);
          //   }

          //   // Render the template
          //   document.body.innerHTML = template;
          // }

          const form = document.forms.namedItem("jo-form");

          form.addEventListener("submit", async (event) => {
            event.preventDefault();

            const formData = new FormData(form);

            console.log("formData is = ", formData);
            
            console.log("hr_tgl_ambil value is = ", $(`#hr_tgl_ambil`).datepicker("getDate"));
            console.log("jumlah value is = ", $(`#qty`).val());
            // let dp_masuk = Date.parse($(`${formName} #modal-form-${index + 1} .tgl_masuk`).datepicker("getDate"))
            // console.log("status value is = ", $("input[name='status']:checked").val());

            console.log("list merk = ", formData.getAll('merk'));
            console.log("list tipe = ", formData.getAll('tipe'));
            console.log("list nopol_noka = ", formData.getAll('nopol_noka'));
            console.log("list warna = ", formData.getAll('warna'));
            console.log("list status = ", formData.getAll('status'));
            console.log("list kondisi = ", formData.getAll('kondisi'));
            console.log("list lainnya = ", formData.getAll('lainnya'));

            let no_joj = $("#no_joj").val();
            let hr_tgl_ambil = $('#hr_tgl_ambil').val();
            // let tgl_wkt_dibuat = $(new Date()).datepicker("getDate");
            let nama_pengirim = $(`#nama_pengirim`).val();
            let alamat_pengirim = $(`#alamat_pengirim`).val();
            let kontak_pengirim = $(`#kontak_pengirim`).val();
            let nama_penerima = $(`#nama_penerima`).val();
            let alamat_penerima = $(`#alamat_penerima`).val();
            let kontak_penerima = $(`#kontak_penerima`).val();

            console.log("hr_tgl_ambil = ", hr_tgl_ambil);
            // console.log("tgl_wkt_dibuat = ", tgl_wkt_dibuat);
            
            $("#jo-template #content > #header div:nth-child(1) h6").text(`${user.location}, ${moment(new Date()).format('DD MMMM YYYY')}`.toUpperCase());

            $("#jo-template #content > #header div:nth-child(2) span").html(`No. JO : ${city_code + String(moment(new Date()).format('YY'))}<span id="no_joj" contenteditable="true">${String(init_no_joj).padStart(6, '0')}</span>`);
            let qty = $(`#qty`).val();
            let nominal = $("#nominal").val().replace(/,|\Rp/g, '');
            let moda = $(`#moda`).val();
            let invoice = $(`#invoice`).val();
            let transfer_by = $(`#transfer_by`).val();
            let tagihan = form.tagihan.value;
            let tagihan_top = $("#tagihan_top").val();
            let opsi_tagihan_top = tagihan_top ? form.opsi_tagihan_top.value : null;
            let penawaran_kontrak = form.penawaran_kontrak.value;
            let opsi_penawaran_kontrak = penawaran_kontrak === "ada" ? form.opsi_penawaran_kontrak.value : null;
            let no_opsi_penawaran_kontrak = penawaran_kontrak === "ada" ? form.no_opsi_penawaran_kontrak.value  : null;
            let handling = form.handling.value;
            let nominal_handling = handling === "ada" ? form.nominal_handling.value : null;
            let nama_penerima_handling = handling === "ada" ? form.nama_penerima_handling.value : null;
            let asuransi = form.asuransi.value;
            let perincian_asuransi = asuransi === "ada" ? form.perincian_asuransi.value : null;
            let biaya_koord = form.biaya_koord.value;
            let keterangan_biaya_koord = biaya_koord === "ada" ? form.keterangan_biaya_koord.value : null;
            let note = $(`#note`).html();
            console.log("note is = ", note);
            // let ttd_dibuat_oleh = $("#signature-made-by").jSignature('getData', "image/svg+xml;base64").join(',');
            let ttd_dibuat_oleh = $("#signature-made-by").jSignature('getData', "image").join(',');
            console.log("ttd_dibuat_oleh is = ", ttd_dibuat_oleh);

            let isValid = true;

            console.log("is jo form valid = ", $("#jo-form").valid());
            
            
            if ($("#signature-made-by").jSignature('getData', 'native').length == 0) {
              isValid = false;
              // alert('Mohon Tanda Tangan Pembuat JO');
              $("#signature-made-by canvas").css({
                border: "2px solid #ff3366",
              });
              $("#sig-error").show();
            }

            console.log("isValid = ", isValid);

            if ($("#jo-form").valid() && isValid) {
              console.log("new_list_nama_pengirim in job order = ", JSON.stringify(new_list_nama_pengirim, null, '\t'));
              console.log("new_list_alamat_pengirim in job order = ", JSON.stringify(new_list_alamat_pengirim, null, '\t'));
              console.log("new_list_kontak_pengirim in job order = ", JSON.stringify(new_list_kontak_pengirim, null, '\t'));
              console.log("new_list_nama_penerima in job order = ", JSON.stringify(new_list_nama_penerima, null, '\t'));
              console.log("new_list_alamat_penerima in job order = ", JSON.stringify(new_list_alamat_penerima, null, '\t'));
              console.log("new_list_kontak_penerima in job order = ", JSON.stringify(new_list_kontak_penerima, null, '\t'));
              console.log("new_list_merk_unit in job order = ", JSON.stringify(new_list_merk_unit, null, '\t'));
              console.log("new_list_tipe_unit in job order = ", JSON.stringify(new_list_tipe_unit, null, '\t'));
              console.log("new_list_warna_unit in job order = ", JSON.stringify(new_list_warna_unit, null, '\t'));

              let merk = [];
              let tipe = [];
              let nopol_noka = [];
              let warna = [];
              let status = [];
              let kondisi = list_kondisi.map((obj) => { return obj.value; });
              let lainnya = list_lainnya.map((obj) => { return obj.value; });
              

              // List key/value pairs
              for (let [name, value] of formData) {
                console.log("List key/value pairs in formData");
                console.log(`${name} = ${value}`);

                // console.log("obj is = ",Object.keys({name})[0]);
                if (name.split(/\[(.*?)\]/g)[0] === "merk") {
                  merk.push(value)
                } else if (name.split(/\[(.*?)\]/g)[0] === "tipe") {
                  tipe.push(value)
                } else if (name.split(/\[(.*?)\]/g)[0] === "nopol_noka") {
                  nopol_noka.push(value)
                } else if (name.split(/\[(.*?)\]/g)[0] === "warna") {
                  warna.push(value)
                } else if (name.split(/\[(.*?)\]/g)[0] === "status") {
                  status.push(value)
                } 
                // else if (name.split(/\[(.*?)\]/g)[0] === "kondisi") {
                //   kondisi.push(value)
                // } else if (name.split(/\[(.*?)\]/g)[0] === "lainnya") {
                //   lainnya.push(value)
                // }
              }

              new_list_nama_pengirim = new_list_nama_pengirim.map(x => ({ field: x }));
              new_list_alamat_pengirim = new_list_alamat_pengirim.map(x => ({ field: x }));
              new_list_kontak_pengirim = new_list_kontak_pengirim.map(x => ({ field: x }));
              new_list_nama_penerima = new_list_nama_penerima.map(x => ({ field: x }));
              new_list_alamat_penerima = new_list_alamat_penerima.map(x => ({ field: x }));
              new_list_kontak_penerima = new_list_kontak_penerima.map(x => ({ field: x }));
              new_list_merk_unit = new_list_merk_unit.map(x => ({ field: x }));
              new_list_tipe_unit = new_list_tipe_unit.map(x => ({ field: x }));
              new_list_warna_unit = new_list_warna_unit.map(x => ({ field: x }));

              const Toast = Swal.mixin({
                toast: true,
                position: 'bottom-start',
                showConfirmButton: false,
                timer: 5000,
                timerProgressBar: true,
              });
            
              try {
                const response = await fetch("/input-job-order", {
                  method: "POST",
                  // body: formData,
                  body: JSON.stringify({ 
                    no_joj,
                    city_code,
                    tgl_wkt_dibuat: new Date(),
                    nama_pengirim,
                    alamat_pengirim,
                    kontak_pengirim,
                    nama_penerima,
                    alamat_penerima,
                    kontak_penerima,
                    hr_tgl_ambil,
                    qty,
                    merk,
                    tipe,
                    nopol_noka,
                    warna,
                    status,
                    kondisi,
                    lainnya,
                    new_list_nama_pengirim,
                    new_list_alamat_pengirim,
                    new_list_kontak_pengirim,
                    new_list_nama_penerima,
                    new_list_alamat_penerima,
                    new_list_kontak_penerima,
                    new_list_merk_unit,
                    new_list_tipe_unit,
                    new_list_warna_unit,
                    nominal,
                    moda,
                    invoice,
                    transfer_by,
                    tagihan,
                    tagihan_top,
                    opsi_tagihan_top,
                    penawaran_kontrak,
                    opsi_penawaran_kontrak,
                    no_opsi_penawaran_kontrak,
                    handling,
                    nominal_handling,
                    nama_penerima_handling,
                    asuransi,
                    perincian_asuransi,
                    biaya_koord,
                    keterangan_biaya_koord,
                    note,
                    dibuat_oleh: user.username,
                    ttd_dibuat_oleh,
                   }),
                  headers: {'Content-Type': 'application/json', "Accept":"text/html"},
                  credentials: 'same-origin',
                });
                console.log("response of createData = ", response);

                console.log("response body is = ", response.body);

                if (response.status == 200 || response.ok) {
                  console.log('Promise resolved and HTTP status is successful');
                  // const result = await response.json();
                  // console.log("result from response of createData = ", result);

                  Toast.fire({
                    icon: 'success',
                    html: `<label>Submit Form Success</label>`,
                  });

                  clearInterval(timeInterval);

                  //   // await $.ajax({
              //   //   url: "/job-order-data",
              //   //   type: "GET",
              //   //   dataType: "json",
              //   //   success: async (res) => {
              //   //     console.log("results = ", res);
              //   //   },
              //   //   error: function (err) {
              //   //     console.log("error = ", err);
              //   //   },
              //   // });

                  // return await fetch(`/job-order/${no_joj}`, {
                  //   method: "GET",
                  //   headers: {
                  //     "Content-Type": "application/json",
                  //   },
                  // }).then(res => {
                  //   let htmlText = await response.text();
                  //   document.getElementsByTagName('body')[0].innerHTML(bodyContent);
                    
                  // });

                   // When the page is loaded convert it to text
                  let responseText = await response.text();

                  console.log("responseText is = ", responseText);

                  // Initialize the DOM parser
                  const parser = new DOMParser()

                  // Parse the text
                  const doc = await parser.parseFromString(responseText, "text/html")

                  console.log("final result doc is = ", doc);

                  setTimeout(() => {
                    // app.get("/job-order/:no_joj", checkUser, async(req, res) => {
                      window.history.pushState({}, "United Transindo Admin Dashboard", `/job-order/${no_joj}`);
                      // $('body').html(doc);
                      // $('body').html(responseText);
                      // window.location.reload();

                      let newDoc = document.open("text/html", "replace");
                      newDoc.write(responseText);
                      newDoc.close();
                  }, 1000);

                } else {
                  console.log('error: ', response.status, response.statusText);
                  console.error('Promise resolved but HTTP status failed');
                  // const Toast = Swal.mixin({
                  //   toast: true,
                  //   position: 'bottom-start',
                  //   showConfirmButton: false,
                  //   timer: 5000,
                  //   timerProgressBar: true,
                  // });
                    
                  Toast.fire({
                    icon: 'error',
                    html: `<label>There are some errors when submitting the form</label>`,
                  });
                  /* Handle the error returned by the HTTP request */
                  return {error: {status: response.status, statusText: response.statusText}};
                }
                
                // const now = performance.now();
                // for (let l = 0; l < 1000000; l += 1)
                //   getRow();
                // console.log(performance.now() - now);
              } catch (err) {
                console.error(err)
                
                // const Toast = Swal.mixin({
                //   toast: true,
                //   position: 'bottom-start',
                //   showConfirmButton: false,
                //   timer: 5000,
                //   timerProgressBar: true,
                // });
                  
                Toast.fire({
                  icon: 'error',
                  html: `<label>Submit Form Failed</label>`,
                });
              }
            } else {
              console.log("there is invalid input in Input Form Job Order");
            }
          });

        });
      
    </script>
  </body>
</html>
